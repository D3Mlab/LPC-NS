==================== Evaluating with noise_std = 0.9 in Dataset 1 with random state = 4 ====================
ODS is enabled
mse 0.7525051982657541
Splitting data into training and validation set
Not whitening the data...
Set parameter TokenServer to value "license1.computecanada.ca"
Set parameter Threads to value 16
Read parameters from file gurobi.env
Set parameter MIPGap to value 0.05
Set parameter TimeLimit to value 36000
Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (linux64 - "AlmaLinux 9.3 (Shamrock Pampas Cat)")

CPU model: Intel(R) Xeon(R) Platinum 8260 CPU @ 2.40GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 48 physical cores, 48 logical processors, using up to 16 threads

Optimize a model with 72 rows, 312 columns and 216 nonzeros
Model fingerprint: 0xbd948229
Model has 84 quadratic objective terms
Model has 216 general constraints
Variable types: 96 continuous, 216 integer (216 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [0e+00, 0e+00]
  QObjective range [2e-02, 2e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
  GenCon rhs range [1e+00, 2e+01]
  GenCon coe range [3e-03, 5e+00]
Presolve added 216 rows and 204 columns
Presolve time: 0.02s
Presolved: 288 rows, 516 columns, 1512 nonzeros
Presolved model has 216 SOS constraint(s)
Presolved model has 84 quadratic objective terms
Variable types: 300 continuous, 216 integer (216 binary)

Root relaxation: objective 0.000000e+00, 577 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    0.00000    0   72          -    0.00000      -     -    0s
H    0     0                    7488.1974114    0.00000   100%     -    0s
H    0     0                    6870.3980066    0.00000   100%     -    0s
     0     0    0.16483    0   71 6870.39801    0.16483   100%     -    0s
     0     2    0.16483    0   71 6870.39801    0.16483   100%     -    0s
H   33    48                    6807.6609668    0.16483   100%   2.5    0s
H   35    48                    6517.3250582    0.16483   100%   2.5    0s
H   42    48                    6306.2682924    0.16483   100%   2.6    0s
H   46    48                    6207.8131910    0.16483   100%   2.6    0s
H   79    96                    5771.6969782    0.16483   100%   2.4    0s
H  534   625                    5247.4680395    0.16483   100%   2.5    0s
H 1600  1641                    5057.3374939    0.17698   100%   2.4    0s
H 1601  1641                    4228.4566368    0.17698   100%   2.4    0s
H 1601  1641                    3841.9690466    0.17698   100%   2.4    0s
H 1603  1641                    3626.6626815    0.17698   100%   2.4    0s
H 1631  1641                    3558.1245780    0.17698   100%   2.4    0s
H 1638  1641                    3455.2579999    0.17698   100%   2.4    0s
H 1650  1882                    2382.8849516    0.17698   100%   2.4    0s
H 1681  1882                    2268.6191536    0.17698   100%   2.4    0s
H 1806  1882                    1716.8748893    0.17698   100%   2.4    0s
H 1857  1882                    1645.9353215    0.17698   100%   2.4    0s
H 3302  3747                    1557.3997353    0.17698   100%   2.3    0s
H 3305  3715                    1401.1989729    0.17698   100%   2.3    0s
H 3337  3183                     656.3157655    0.17698   100%   2.3    0s
H 3594  2699                     389.3309514    0.17698   100%   2.3    0s
H 3597  2689                     385.7262753    0.17698   100%   2.3    0s
H 5405  3331                     361.6848571    0.17986   100%   2.2    0s
H 5461  3137                     353.3914137    0.17986   100%   2.2    0s
H 5463  2981                     352.8023835    0.17986   100%   2.2    0s
H 5545  2894                     348.7633298    0.17986   100%   2.3    0s
H 5552  2749                     348.3740157    0.17986   100%   2.3    0s
H 5553  2615                     346.0300690    0.17986   100%   2.3    0s
H 5613  2523                     343.8641270    0.17986   100%   2.3    0s
H 5775  2518                     323.5619919    0.17986   100%   2.3    0s
H 6808  2967                     322.3817514    0.17986   100%   2.3    0s
H 6813  2845                     309.4658059    0.17986   100%   2.3    0s
H 6822  2794                     307.1502546    0.17986   100%   2.3    0s
H 6841  2601                     249.8982888    0.17986   100%   2.3    0s
H 6896  2577                     243.2575301    0.17986   100%   2.3    0s
H 6934  2452                     232.6743186    0.17986   100%   2.3    0s
H14833  6233                     232.0968511    0.30777   100%   2.2    1s
H18523  7913                     232.0591630    0.34860   100%   2.1    1s
H29128 13483                     232.0355842    0.42627   100%   2.1    1s
H34438 16239                     229.9921306    0.46234   100%   2.1    1s
H76716 40222                     214.0340008    0.73971   100%   2.1    3s
H77974 40124                     212.8811308    0.73971   100%   2.1    3s
*79672 41866             145     212.7226553    0.76117   100%   2.1    3s
H84963 44318                     211.5006657    0.76688   100%   2.1    3s
H85338 44268                     210.8001940    0.76688   100%   2.1    3s
H85752 44266                     210.7449246    0.76688   100%   2.1    3s
H90923 47182                     207.4767074    0.80972   100%   2.1    3s
H112244 59648                     207.3096643    0.91215   100%   2.1    4s
H112415 59532                     206.6602732    0.91215   100%   2.1    4s
H117981 62655                     205.6031392    0.95875   100%   2.1    4s
 128823 68506   73.63133   84   52  205.60314    0.99899   100%   2.1    5s
 278752 148616   19.07156   77   64  205.60314    1.49632  99.3%   2.0   10s
H379759 179739                     152.7571641    1.76204  98.8%   2.0   14s
H379762 176008                     143.2268732    1.76204  98.8%   2.0   14s
H381573 175625                     142.6724518    1.76754  98.8%   2.0   14s
H381575 175464                     142.3828775    1.76754  98.8%   2.0   14s
H381582 171370                     134.0778317    1.76754  98.7%   2.0   14s
H381584 154515                     104.0719716    1.76754  98.3%   2.0   14s
H381588 137749                      78.7459294    1.76754  97.8%   2.0   14s
H383724 138404                      78.4496796    1.76874  97.7%   2.0   14s
H383726 128043                      65.8789850    1.76874  97.3%   2.0   14s
H385461 125907                      62.7393725    1.76874  97.2%   2.0   14s
H385470 124582                      61.1352197    1.76874  97.1%   2.0   14s
 387718 125494   54.07784   96   43   61.13522    1.78062  97.1%   2.0   15s
H387724 122066                      57.3932881    1.78062  96.9%   2.0   15s
H389675 116088                      50.3487837    1.78481  96.5%   2.0   15s
H389698 115459                      49.6913554    1.78481  96.4%   2.0   15s
 647976 217057   49.04431   86   61   49.69136    2.65434  94.7%   1.9   20s
 918756 313315   42.88535   95   51   49.69136    3.47584  93.0%   1.9   25s
 1192028 406881     cutoff   73        49.69136    4.22570  91.5%   1.9   30s
 1464679 492433     cutoff   75        49.69136    4.90440  90.1%   1.9   35s
 1739617 569706   32.60543   77   62   49.69136    5.57190  88.8%   1.8   40s
 2013882 645176   16.72548   72   60   49.69136    6.21330  87.5%   1.8   45s
 2286858 713389     cutoff   91        49.69136    6.85803  86.2%   1.8   50s
H2525375 758886                      48.4018963    7.35977  84.8%   1.8   54s
H2525376 750216                      47.6914730    7.35977  84.6%   1.8   54s
H2525377 748108                      47.5158472    7.35977  84.5%   1.8   54s
H2525383 747543                      47.4675210    7.35977  84.5%   1.8   54s
 2528548 748920   11.25239   82   64   47.46752    7.36569  84.5%   1.8   55s
 2804043 803537   37.49757   93   51   47.46752    8.00031  83.1%   1.8   60s
 3078491 853653     cutoff   75        47.46752    8.62057  81.8%   1.8   65s
 3353056 897464     cutoff  101        47.46752    9.25971  80.5%   1.8   70s
 3629266 939807     cutoff   67        47.46752    9.85514  79.2%   1.8   75s
 3902187 977514   46.59357   99   48   47.46752   10.44895  78.0%   1.7   80s
 4163572 1010176     cutoff   85        47.46752   11.02141  76.8%   1.7   85s
 4407869 1037049   21.77354   81   59   47.46752   11.54178  75.7%   1.7   90s
 4645429 1061920     cutoff   87        47.46752   12.03880  74.6%   1.7   95s
H4699433 1067177                      47.4634634   12.15620  74.4%   1.7   96s
 4859021 1080941     cutoff   92        47.46346   12.49451  73.7%   1.7  100s
 5099729 1101016   37.73969   86   65   47.46346   12.98603  72.6%   1.7  105s
 5336827 1121307     cutoff   97        47.46346   13.45662  71.6%   1.7  110s
 5565651 1140486   35.06431   85   55   47.46346   13.90465  70.7%   1.7  115s
 5805031 1156797   14.98321   83   64   47.46346   14.36979  69.7%   1.7  120s
 6048475 1172977   21.13976  104   43   47.46346   14.83548  68.7%   1.7  125s
 6282431 1187113   41.05525   79   59   47.46346   15.26739  67.8%   1.7  130s
 6522050 1200172     cutoff   79        47.46346   15.72847  66.9%   1.7  135s
 6746338 1211392     cutoff   98        47.46346   16.16696  65.9%   1.7  140s
 6981187 1222697   18.81424   82   64   47.46346   16.61078  65.0%   1.7  145s
 7213237 1233724     cutoff   47        47.46346   17.06600  64.0%   1.7  150s
 7448611 1242591   40.27879   76   68   47.46346   17.53890  63.0%   1.7  155s
 7695633 1252879     cutoff   94        47.46346   18.03989  62.0%   1.7  160s
 7931453 1260359     cutoff   90        47.46346   18.52922  61.0%   1.7  165s
 8164765 1265573     cutoff   93        47.46346   19.02854  59.9%   1.7  170s
 8408151 1273527   45.16143   76   62   47.46346   19.53785  58.8%   1.7  175s
 8648929 1279626     cutoff   97        47.46346   20.05783  57.7%   1.7  180s
 8887249 1283807   21.21524  102   48   47.46346   20.59437  56.6%   1.7  185s
 9124331 1287227   31.82962   90   61   47.46346   21.12828  55.5%   1.7  190s
 9359053 1288974   24.86076   92   57   47.46346   21.65495  54.4%   1.6  195s
 9597799 1289820     cutoff   84        47.46346   22.18578  53.3%   1.6  200s
 9828723 1291673   47.12890   84   60   47.46346   22.69481  52.2%   1.6  205s
 10079677 1292253   27.32721   87   55   47.46346   23.25374  51.0%   1.6  210s
 10318565 1290952     cutoff   92        47.46346   23.79144  49.9%   1.6  215s
 10541223 1289973   33.55962   97   49   47.46346   24.25762  48.9%   1.6  220s
 10782905 1287324   36.21513  103   47   47.46346   24.77361  47.8%   1.6  225s
 11019144 1286299     cutoff   92        47.46346   25.25288  46.8%   1.6  230s
 11253031 1280734     cutoff   88        47.46346   25.72977  45.8%   1.6  235s
 11495655 1274002   44.41648   87   55   47.46346   26.22457  44.7%   1.6  240s
 11728094 1268815     cutoff   69        47.46346   26.67865  43.8%   1.6  245s
 11959259 1263838   35.56956   65   62   47.46346   27.11972  42.9%   1.6  250s
 12201649 1259354   38.78105   92   57   47.46346   27.56863  41.9%   1.6  255s
 12437018 1256654     cutoff   73        47.46346   28.00177  41.0%   1.6  260s
 12667549 1251608     cutoff   92        47.46346   28.42020  40.1%   1.6  265s
 12906651 1246489     cutoff   78        47.46346   28.84317  39.2%   1.6  270s
 13134838 1239691   31.15890   85   59   47.46346   29.24764  38.4%   1.6  275s
 13367391 1231250   29.66357   68   68   47.46346   29.66176  37.5%   1.6  280s
 13596526 1222133     cutoff   97        47.46346   30.06620  36.7%   1.6  285s
 13834826 1213016   39.74931   76   63   47.46346   30.48082  35.8%   1.6  290s
 14078843 1202560     cutoff   84        47.46346   30.90638  34.9%   1.6  295s
 14320296 1188589     cutoff   84        47.46346   31.33171  34.0%   1.6  300s
 14555572 1175712     cutoff   80        47.46346   31.73433  33.1%   1.6  305s
 14797000 1161961     cutoff   99        47.46346   32.13633  32.3%   1.6  310s
 15034254 1146573     cutoff   77        47.46346   32.53354  31.5%   1.6  315s
 15278732 1130175     cutoff   89        47.46346   32.93934  30.6%   1.6  320s
 15521688 1112181   37.21304   86   56   47.46346   33.33882  29.8%   1.6  325s
 15753102 1093700   44.09686   85   59   47.46346   33.73274  28.9%   1.6  330s
 15983704 1073288   42.89943   77   63   47.46346   34.13699  28.1%   1.6  335s
 16231682 1050809   39.04725   87   55   47.46346   34.56135  27.2%   1.6  340s
 16459703 1028824   38.52331   88   59   47.46346   34.95480  26.4%   1.6  345s
 16688125 1006578     cutoff   82        47.46346   35.34703  25.5%   1.6  350s
 16933798 981422     cutoff   89        47.46346   35.77756  24.6%   1.6  355s
 17164323 953691     cutoff   89        47.46346   36.19282  23.7%   1.6  360s
 17401525 925764   44.84448   92   59   47.46346   36.61700  22.9%   1.6  365s
 17632099 897791     cutoff   86        47.46346   37.02352  22.0%   1.6  370s
 17877020 865929   37.47192   84   64   47.46346   37.46576  21.1%   1.6  375s
 18109086 836028     cutoff   97        47.46346   37.88584  20.2%   1.6  380s
 18339289 806084     cutoff   78        47.46346   38.29550  19.3%   1.6  385s
 18587631 770929   38.79104   85   59   47.46346   38.75492  18.3%   1.6  390s
 18831627 733051   43.32939   85   58   47.46346   39.21919  17.4%   1.6  395s
 19080610 693995     cutoff   85        47.46346   39.69848  16.4%   1.6  400s
 19325396 654630     cutoff   82        47.46346   40.18033  15.3%   1.6  405s
 19574715 609068   44.98246   83   61   47.46346   40.68710  14.3%   1.6  410s
 19801304 566324     cutoff   88        47.46346   41.16230  13.3%   1.6  415s
 20038544 518573     cutoff   98        47.46346   41.66165  12.2%   1.6  420s
 20274401 466473     cutoff   87        47.46346   42.19219  11.1%   1.6  425s
 20502887 413925   45.09659   85   58   47.46346   42.72338  10.0%   1.6  430s
 20743928 353807     cutoff  102        47.46346   43.32116  8.73%   1.6  435s
 20978766 288809   44.34513   87   53   47.46346   43.97716  7.35%   1.6  440s
 21227580 208122     cutoff   74        47.46346   44.79494  5.62%   1.6  445s

Explored 21309221 nodes (33139562 simplex iterations) in 446.71 seconds (364.18 work units)
Thread count was 16 (of 48 available processors)

Solution count 10: 47.4635 47.4675 47.5158 ... 65.879

Optimal solution found (tolerance 5.00e-02)
Best objective 4.746346341311e+01, best bound 4.509617977882e+01, gap 4.9876%
Optimal solution found.
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 2 1 1 1 2 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 1 2 2 2 2 1 2 2 2 2 2 2 2 2 2 1 2 2 2]
Cluster Assignments from Gurobi MIQP using MSE

Cluster 0 weights w_0^* (including bias) in original space:
[-9.73710346 -1.256719   -1.77356657 -1.38507379]

Cluster 1 weights w_1^* (including bias) in original space:
[1.56215882 1.82306965 1.63687961 0.72884996]

Cluster 2 weights w_2^* (including bias) in original space:
[9.92417964 0.66101354 0.14751461 0.03635148]
############################################################################

Ridge Regression using scikit-learn:
Optimal weights w* in X Space (including bias):
[9.54315494e-01 7.16911346e-05 1.87959654e-03 7.48072585e-04]

Mean Squared Error on training data (scikit-learn) with lambda = 0.1:
104.00113272372771
Cluster assignments:  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 2 1 1 1 2 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 1 2 2 2 2 1 2 2 2 2 2 2 2 2 2 1 2 2 2]
-----------------------------------
Regression weights for cluster 0: y = -1.2567x_0 + -1.7736x_1 + -1.3851x_2 + -9.7371
Regression weights for cluster 0 after refit: y = -1.2458x_1 + -1.7675x_2 + -1.3789x_3 + -9.7626
-----------------------------------
Regression weights for cluster 1: y = 1.8231x_0 + 1.6369x_1 + 0.7288x_2 + 1.5622
Regression weights for cluster 1 after refit: y = 1.8233x_1 + 1.6371x_2 + 0.7283x_3 + 1.5631
-----------------------------------
Regression weights for cluster 2: y = 0.661x_0 + 0.1475x_1 + 0.0364x_2 + 9.9242
Regression weights for cluster 2 after refit: y = 0.661x_1 + 0.1427x_2 + 0.0329x_3 + 9.9368
{'time_milp': 447.75438046455383, 'time_greedy': np.float64(0.47939610481262207), 'time_refit_milp_assignment': 450.48662209510803, 'mse_refit_ground_truth_assignment': np.float64(0.6761391447364999), 'r2_refit_ground_truth_assignment': 0.9939283984204867, 'weight_mismatch_refit_ground_truth_assignment': np.float64(1.6399872655588075), 'refit-weight_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'rand_score_refit_ground_truth_assignment': 1.0, 'label_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'mse_milp': np.float64(0.6301344395108404), 'r2_milp': 0.9943415119683231, 'weight_mismatch_milp': np.float64(1.6800419877645454), 'refit-weight_mismatch_milp': np.float64(0.9264675114000163), 'rand_score_milp': np.float64(0.9158841940532081), 'label_mismatch_milp': np.float64(0.06944444444444445), 'mse_refit_milp_assignment': np.float64(0.6300869908408759), 'r2_refit_milp_assignment': 0.9943419380484011, 'weight_mismatch_refit_milp_assignment': np.float64(1.660815199220554), 'refit-weight_mismatch_refit_milp_assignment': np.float64(0.8878452619439359), 'rand_score_refit_milp_assignment': np.float64(0.9158841940532081), 'label_mismatch_refit_milp_assignment': np.float64(0.06944444444444445), 'mse_greedy': np.float64(3.422677897005048), 'r2_greedy': np.float64(0.969265000129937), 'weight_mismatch_greedy': np.float64(8.665169616981622), 'refit-weight_mismatch_greedy': np.float64(8.075702759044365), 'rand_score_greedy': np.float64(0.8480242566510171), 'label_mismatch_greedy': np.float64(0.16666666666666666), 'mse_greedy_sem': np.float64(1.0417073926415819), 'r2_greedy_sem': np.float64(0.009354335272243575), 'weight_mismatch_greedy_sem': np.float64(2.4105631441951334), 'refit-weight_mismatch_greedy_sem': np.float64(2.5525034137353204), 'rand_score_greedy_sem': np.float64(0.0259291257397629), 'label_mismatch_greedy_sem': np.float64(0.03292883223260019), 'mse_ground_truth': np.float64(0.7525051982657541), 'r2_ground_truth': np.float64(0.9932661113149157), 'weight_mismatch_ground_truth': 0, 'rand_score_ground_truth': 1, 'label_mismatch_ground_truth': 0, 'mse_baseline_sklearn': np.float64(104.00113272372771), 'r2_baseline_sklearn': np.float64(0.06608950741546515), 'mse_milp_val': np.float64(1.2734315317956997), 'r2_milp_val': 0.9886442603936837, 'label_mismatch_milp_val': np.float64(0.0625), 'mse_refit_milp_assignment_val': np.float64(1.2741041844886387), 'r2_refit_milp_assignment_val': 0.9886382620587628, 'label_mismatch_refit_milp_assignment_val': np.float64(0.0625), 'mse_greedy_val': np.float64(8.450326776091078), 'label_mismatch_greedy_val': np.float64(0.15416666666666665), 'mse_greedy_val_sem': np.float64(2.9731145685801033), 'label_mismatch_greedy_val_sem': np.float64(0.033640307989633904), 'r2_greedy_val': np.float64(0.9246447821798023), 'r2_greedy_val_sem': np.float64(0.026512548195608648), 'mse_refit_ground_truth_assignment_val': np.float64(1.0521758258066078), 'r2_refit_ground_truth_assignment_val': 0.9906172931959112, 'label_mismatch_refit_ground_truth_assignment_val': np.float64(0.041666666666666664), 'mse_ground_truth_val': np.float64(1.0714600685944966), 'r2_ground_truth_val': 0.9904453272643817, 'label_mismatch_ground_truth_val': np.float64(0.041666666666666664), 'mse_baseline_sklearn_val': np.float64(112.46751758338921), 'r2_baseline_sklearn_val': -0.002921485731413709}
