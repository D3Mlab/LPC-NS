==================== Evaluating with noise_std = 0.9 in Dataset 1 with random state = 2 ====================
ODS is enabled
mse 0.90948805876057
Splitting data into training and validation set
Not whitening the data...
Set parameter TokenServer to value "license1.computecanada.ca"
Set parameter Threads to value 16
Read parameters from file gurobi.env
Set parameter MIPGap to value 0.05
Set parameter TimeLimit to value 36000
Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (linux64 - "AlmaLinux 9.3 (Shamrock Pampas Cat)")

CPU model: Intel(R) Xeon(R) Platinum 8260 CPU @ 2.40GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 48 physical cores, 48 logical processors, using up to 16 threads

Optimize a model with 72 rows, 312 columns and 216 nonzeros
Model fingerprint: 0x9d5b48ea
Model has 84 quadratic objective terms
Model has 216 general constraints
Variable types: 96 continuous, 216 integer (216 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [0e+00, 0e+00]
  QObjective range [2e-02, 2e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
  GenCon rhs range [9e-01, 2e+01]
  GenCon coe range [3e-03, 4e+00]
Presolve added 216 rows and 204 columns
Presolve time: 0.02s
Presolved: 288 rows, 516 columns, 1512 nonzeros
Presolved model has 216 SOS constraint(s)
Presolved model has 84 quadratic objective terms
Variable types: 300 continuous, 216 integer (216 binary)

Root relaxation: objective 0.000000e+00, 577 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    0.00000    0   72          -    0.00000      -     -    0s
H    0     0                    7947.2356433    0.00000   100%     -    0s
H    0     0                    7368.1465325    0.00000   100%     -    0s
     0     0    0.37568    0   71 7368.14653    0.37568   100%     -    0s
     0     2    0.37568    0   71 7368.14653    0.37568   100%     -    0s
H   32    48                    7345.4474578    0.37568   100%   2.4    0s
H   35    48                    6754.6775847    0.37568   100%   2.5    0s
H   79    96                    6218.1192664    0.37568   100%   2.4    0s
H  434   492                    5878.3454391    0.37568   100%   2.5    0s
H  442   492                    5759.7078001    0.37568   100%   2.5    0s
H  445   492                    5542.3847252    0.37568   100%   2.5    0s
H  464   492                    5362.8319939    0.37568   100%   2.5    0s
H  483   492                    5279.1969535    0.37568   100%   2.5    0s
H 1307  1468                    4576.7074529    0.37568   100%   2.5    0s
H 1325  1468                    3995.2634316    0.38730   100%   2.5    0s
H 1415  1468                    3836.6499683    0.38730   100%   2.5    0s
H 2141  2572                    2389.0131566    0.38730   100%   2.4    0s
H 3099  3674                    1167.3315357    0.38730   100%   2.3    0s
H 3108  3638                     883.1820740    0.38730   100%   2.3    0s
H 3111  3636                     879.2752884    0.38730   100%   2.3    0s
H 3501  3610                     818.7573695    0.38730   100%   2.3    0s
H 3510  3348                     568.8397064    0.38730   100%   2.3    0s
H 4200  3153                     394.3832354    0.43052   100%   2.3    0s
H 4402  3486                     349.7947922    0.43052   100%   2.3    0s
H 4403  3455                     316.8513511    0.43052   100%   2.3    0s
H 5131  3306                     309.7900314    0.43052   100%   2.4    0s
H 5143  3139                     282.0069371    0.43052   100%   2.4    0s
H 5176  3016                     275.6748849    0.43052   100%   2.4    0s
H 5291  2965                     273.2691146    0.43052   100%   2.4    0s
H 5421  2887                     226.5845503    0.43052   100%   2.4    0s
H 6450  3277                     225.5624727    0.43052   100%   2.4    0s
H 6459  3146                     225.3919174    0.43052   100%   2.4    0s
H20414  9614                     224.0890196    0.52916   100%   2.1    1s
H20415  9614                     224.0062115    0.52916   100%   2.1    1s
H21550 10062                     216.4581184    0.53915   100%   2.1    1s
H27618 12738                     213.9405457    0.58396   100%   2.1    1s
H32772 15507                     213.1217889    0.61584   100%   2.1    1s
 113411 54877  120.99299   68   67  213.12179    1.01918   100%   2.0    5s
H165381 79644                     211.2076585    1.22504  99.4%   2.0    7s
H167596 80241                     208.8990344    1.23749  99.4%   2.0    7s
H169714 80534                     205.0616943    1.24837  99.4%   1.9    8s
H171610 81498                     205.0248173    1.25859  99.4%   1.9    8s
H172006 81870                     204.3446850    1.25859  99.4%   1.9    8s
H174536 82976                     203.8991514    1.26763  99.4%   1.9    8s
H185241 88685                     203.7074340    1.28307  99.4%   2.0    9s
H188337 89512                     202.6368135    1.29310  99.4%   1.9    9s
 198793 94979   25.96262   84   64  202.63681    1.34609  99.3%   1.9   10s
 279224 136401  141.70263   93   52  202.63681    1.52734  99.2%   1.9   15s
 365036 175756   60.68351   89   63  202.63681    1.77228  99.1%   1.9   20s
 488048 233735   74.24364   81   55  202.63681    2.02897  99.0%   1.9   25s
H539497 156397                      58.6595738    2.15331  96.3%   1.9   27s
H541131 154783                      57.4253959    2.15718  96.2%   1.9   27s
H541446 154135                      56.9751533    2.15718  96.2%   1.9   27s
H541695 152957                      55.3093299    2.15742  96.1%   1.9   27s
H543895 152607                      55.0123865    2.15742  96.1%   1.9   27s
 602239 175157   40.45635   81   57   55.01239    2.34690  95.7%   1.9   30s
 846141 260401    5.79363   72   68   55.01239    3.01981  94.5%   1.9   35s
 999316 310637   33.62096   79   68   55.01239    3.39745  93.8%   1.9   40s
 1212880 374799   32.36001   81   68   55.01239    3.87793  93.0%   1.9   45s
 1476686 450966   28.89489   81   60   55.01239    4.42119  92.0%   1.8   50s
 1727409 516911   32.42649   78   55   55.01239    4.92895  91.0%   1.8   55s
 1892439 557820   11.45611   92   53   55.01239    5.25053  90.5%   1.8   60s
 2089075 605233   21.07208   84   51   55.01239    5.61212  89.8%   1.8   65s
 2244260 641315    6.64733   82   65   55.01239    5.89452  89.3%   1.8   70s
H2440901 634934                      50.4080217    6.24483  87.6%   1.8   74s
H2440906 634390                      50.3573127    6.24483  87.6%   1.8   74s
H2440922 633856                      50.3140105    6.24483  87.6%   1.8   74s
H2442043 629973                      49.9589231    6.24522  87.5%   1.8   75s
H2442063 629630                      49.9313454    6.24522  87.5%   1.8   75s
 2582908 657998     cutoff   79        49.93135    6.51162  87.0%   1.8   80s
 2744146 688554   13.22020   82   65   49.93135    6.80622  86.4%   1.8   85s
 2914385 719096     cutoff   73        49.93135    7.12238  85.7%   1.8   90s
 3067315 743760   48.53659   94   53   49.93135    7.41053  85.2%   1.8   95s
 3208483 766986   33.09400   98   49   49.93135    7.66800  84.6%   1.8  100s
 3390138 795740     cutoff  106        49.93135    7.99268  84.0%   1.8  105s
 3583513 824878     cutoff   86        49.93135    8.33442  83.3%   1.7  110s
 3771936 850228   37.80709   94   54   49.93135    8.65998  82.7%   1.7  115s
 4022506 883052   17.59367   84   64   49.93135    9.09313  81.8%   1.7  120s
 4257773 911014     cutoff  106        49.93135    9.46493  81.0%   1.7  125s
 4500177 943230     cutoff  100        49.93135    9.82361  80.3%   1.7  130s
 4670172 960495   32.62308   85   63   49.93135   10.07174  79.8%   1.7  135s
 4913988 985719     cutoff   92        49.93135   10.40880  79.2%   1.7  140s
 5158004 1008696   10.76579   40   68   49.93135   10.76236  78.4%   1.7  145s
 5405566 1029443   29.13985   91   53   49.93135   11.11791  77.7%   1.7  150s
 5625335 1048555   45.44991   94   55   49.93135   11.45065  77.1%   1.7  155s
 5849427 1069252   26.03686   86   58   49.93135   11.79044  76.4%   1.7  160s
 6067068 1084687   46.07792   80   61   49.93135   12.14103  75.7%   1.7  165s
 6289331 1105169     cutoff   87        49.93135   12.48877  75.0%   1.7  170s
 6514147 1119880   30.72879   80   60   49.93135   12.87357  74.2%   1.7  175s
 6733038 1135535   34.08999   99   44   49.93135   13.26632  73.4%   1.7  180s
 6964769 1148988     cutoff   76        49.93135   13.69729  72.6%   1.7  185s
 7194608 1162679     cutoff   88        49.93135   14.10977  71.7%   1.7  190s
 7408281 1175356     cutoff   97        49.93135   14.51647  70.9%   1.7  195s
 7624797 1184288   24.41746   88   60   49.93135   14.93730  70.1%   1.7  200s
 7851223 1194169     cutoff   79        49.93135   15.39285  69.2%   1.7  205s
 8073291 1202518   16.69634  103   50   49.93135   15.85802  68.2%   1.7  210s
 8298329 1212405     cutoff  110        49.93135   16.31845  67.3%   1.7  215s
 8522345 1221635   31.20380   85   64   49.93135   16.79251  66.4%   1.7  220s
 8753128 1230510   23.23695   87   64   49.93135   17.26990  65.4%   1.7  225s
 8976580 1239999   37.08287  102   49   49.93135   17.73685  64.5%   1.7  230s
 9207826 1249613     cutoff   87        49.93135   18.21862  63.5%   1.7  235s
 9425326 1255619     cutoff   91        49.93135   18.68325  62.6%   1.6  240s
 9649106 1262024   39.48073   88   56   49.93135   19.15686  61.6%   1.6  245s
 9867309 1266950     cutoff  111        49.93135   19.61730  60.7%   1.6  250s
 10089754 1270823     cutoff  100        49.93135   20.07925  59.8%   1.6  255s
 10304648 1274305     cutoff   92        49.93135   20.51221  58.9%   1.6  260s
 10527044 1278114   45.89518   88   50   49.93135   20.96059  58.0%   1.6  265s
 10759295 1281355     cutoff  102        49.93135   21.42880  57.1%   1.6  270s
 10935353 1283422   24.96882   94   52   49.93135   21.78617  56.4%   1.6  275s
 11157434 1283842     cutoff   83        49.93135   22.23988  55.5%   1.6  280s
 11379431 1285908     cutoff   96        49.93135   22.68105  54.6%   1.6  285s
 11598754 1289216   45.42403   79   64   49.93135   23.10279  53.7%   1.6  290s
 11815376 1292096     cutoff  100        49.93135   23.50948  52.9%   1.6  295s
 12036888 1292334     cutoff   86        49.93135   23.92895  52.1%   1.6  300s
 12239981 1295156   38.98211   80   58   49.93135   24.29982  51.3%   1.6  305s
 12473021 1295426     cutoff   95        49.93135   24.72235  50.5%   1.6  310s
 12693863 1294959   41.58379  108   43   49.93135   25.13453  49.7%   1.6  315s
 12911977 1295290     cutoff  100        49.93135   25.52536  48.9%   1.6  320s
 13131652 1295807     cutoff   98        49.93135   25.90920  48.1%   1.6  325s
 13353086 1294136   42.05086   95   55   49.93135   26.29502  47.3%   1.6  330s
 13559243 1292001     cutoff  100        49.93135   26.66077  46.6%   1.6  335s
 13765368 1289078     cutoff   96        49.93135   27.02197  45.9%   1.6  340s
 13990075 1284593   28.48496   98   49   49.93135   27.41186  45.1%   1.6  345s
 14213658 1280633     cutoff   97        49.93135   27.78762  44.3%   1.6  350s
 14429874 1275215   29.00590   86   54   49.93135   28.14962  43.6%   1.6  355s
 14647715 1270037   37.02437   86   57   49.93135   28.51705  42.9%   1.6  360s
 14876496 1264055   30.41629   91   56   49.93135   28.89644  42.1%   1.6  365s
 15088946 1257777   38.47968   85   60   49.93135   29.25125  41.4%   1.6  370s
 15315458 1252249     cutoff  103        49.93135   29.61342  40.7%   1.6  375s
 15524966 1246334   30.89834   76   54   49.93135   29.94522  40.0%   1.6  380s
 15735522 1240826     cutoff   96        49.93135   30.26901  39.4%   1.6  385s
 15964740 1235969   30.62245   38   69   49.93135   30.62090  38.7%   1.6  390s
 16183684 1228562     cutoff   80        49.93135   30.95452  38.0%   1.6  395s
 16408603 1221615   38.05148   85   63   49.93135   31.30307  37.3%   1.6  400s
 16631077 1213927     cutoff   93        49.93135   31.64258  36.6%   1.6  405s
 16857887 1206399   35.70445   87   61   49.93135   31.98603  35.9%   1.6  410s
 17077720 1198107   33.30025   89   61   49.93135   32.31459  35.3%   1.6  415s
 17295330 1189742     cutoff   81        49.93135   32.64913  34.6%   1.6  420s
 17523895 1179469     cutoff   96        49.93135   33.00841  33.9%   1.6  425s
 17736343 1171096   34.41538   95   52   49.93135   33.33670  33.2%   1.6  430s
 17951441 1159090     cutoff   91        49.93135   33.68007  32.5%   1.6  435s
 18172438 1147373     cutoff   85        49.93135   34.04094  31.8%   1.6  440s
 18394345 1136406     cutoff  104        49.93135   34.39947  31.1%   1.6  445s
 18606183 1124115     cutoff   83        49.93135   34.74561  30.4%   1.6  450s
 18831268 1111579     cutoff   89        49.93135   35.10727  29.7%   1.6  455s
 19058182 1096178     cutoff   96        49.93135   35.48402  28.9%   1.6  460s
 19275181 1081428     cutoff   94        49.93135   35.84129  28.2%   1.6  465s
 19496983 1065899   37.72868   92   58   49.93135   36.20702  27.5%   1.6  470s
 19717208 1049544   37.70097   90   60   49.93135   36.56961  26.8%   1.6  475s
 19934279 1032041     cutoff   81        49.93135   36.93077  26.0%   1.6  480s
 20147081 1015590   49.34799   93   45   49.93135   37.28430  25.3%   1.6  485s
 20376272 996937   48.38707   93   50   49.93135   37.66825  24.6%   1.6  490s
 20582734 979193     cutoff   95        49.93135   38.01168  23.9%   1.6  495s
 20806800 959235     cutoff   91        49.93135   38.38725  23.1%   1.6  500s
 21021795 940893   48.67499   87   59   49.93135   38.75161  22.4%   1.6  505s
 21249647 919853   48.70843   93   50   49.93135   39.14275  21.6%   1.6  510s
 21463014 899779   39.95628   84   66   49.93135   39.50278  20.9%   1.6  515s
 21688144 876988     cutoff   98        49.93135   39.89315  20.1%   1.6  520s
 21899610 855023     cutoff   83        49.93135   40.26664  19.4%   1.6  525s
 22115241 832815   42.30153   98   51   49.93135   40.64588  18.6%   1.6  530s
 22341571 806593     cutoff   96        49.93135   41.05923  17.8%   1.6  535s
 22560497 779712   48.00414   83   64   49.93135   41.46199  17.0%   1.6  540s
 22784895 750892   48.41752   93   50   49.93135   41.88643  16.1%   1.6  545s
 23001250 720145     cutoff  102        49.93135   42.30271  15.3%   1.6  550s
 23224889 688397     cutoff   95        49.93135   42.74041  14.4%   1.6  555s
 23442104 653175     cutoff   85        49.93135   43.18662  13.5%   1.6  560s
 23660052 611231   43.97823   83   63   49.93135   43.65973  12.6%   1.6  565s
 23878073 565170   47.89269   89   59   49.93135   44.15203  11.6%   1.6  570s
 24107352 512054   46.03513   96   48   49.93135   44.69702  10.5%   1.6  575s
 24326297 455922     cutoff   83        49.93135   45.23557  9.40%   1.6  580s
 24537820 400218     cutoff   99        49.93135   45.76695  8.34%   1.6  585s
 24764295 338098   48.07830   90   57   49.93135   46.34733  7.18%   1.6  590s
 24967089 276419   48.29976  100   51   49.93135   46.91488  6.04%   1.6  595s

Explored 25142893 nodes (39000300 simplex iterations) in 599.23 seconds (439.23 work units)
Thread count was 16 (of 48 available processors)

Solution count 10: 49.9313 49.9589 50.408 ... 203.707

Optimal solution found (tolerance 5.00e-02)
Best objective 4.993134544631e+01, best bound 4.744079256626e+01, gap 4.9880%
Optimal solution found.
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Cluster Assignments from Gurobi MIQP using MSE

Cluster 0 weights w_0^* (including bias) in original space:
[-10.47415577  -1.22161677  -1.45055369  -1.07320542]

Cluster 1 weights w_1^* (including bias) in original space:
[10.18478711  0.16634176 -0.019766   -0.11844994]

Cluster 2 weights w_2^* (including bias) in original space:
[1.22741139 1.42395829 1.82722253 0.79343366]
############################################################################

Ridge Regression using scikit-learn:
Optimal weights w* in X Space (including bias):
[ 6.06088498e-01 -2.01066247e-05  4.37668264e-04  1.91735792e-04]

Mean Squared Error on training data (scikit-learn) with lambda = 0.1:
110.37820297932691
Cluster assignments:  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
-----------------------------------
Regression weights for cluster 0: y = -1.2216x_0 + -1.4506x_1 + -1.0732x_2 + -10.4742
Regression weights for cluster 0 after refit: y = -1.2164x_1 + -1.4473x_2 + -1.0679x_3 + -10.4909
-----------------------------------
Regression weights for cluster 1: y = 0.1663x_0 + -0.0198x_1 + -0.1184x_2 + 10.1848
Regression weights for cluster 1 after refit: y = 0.1638x_1 + -0.0251x_2 + -0.121x_3 + 10.1986
-----------------------------------
Regression weights for cluster 2: y = 1.424x_0 + 1.8272x_1 + 0.7934x_2 + 1.2274
Regression weights for cluster 2 after refit: y = 1.4241x_1 + 1.8278x_2 + 0.793x_3 + 1.2278
{'time_milp': 600.8548798561096, 'time_greedy': np.float64(0.48906888961791994), 'time_refit_milp_assignment': 603.59179520607, 'mse_refit_ground_truth_assignment': np.float64(0.6620976201926531), 'r2_refit_ground_truth_assignment': 0.9940253553348696, 'weight_mismatch_refit_ground_truth_assignment': np.float64(1.3432869946485826), 'refit-weight_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'rand_score_refit_ground_truth_assignment': 1.0, 'label_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'mse_milp': np.float64(0.662139434429451), 'r2_milp': 0.9940249780110442, 'weight_mismatch_milp': np.float64(1.3137684271128849), 'refit-weight_mismatch_milp': np.float64(0.034759897038672244), 'rand_score_milp': 1.0, 'label_mismatch_milp': np.float64(0.0), 'mse_refit_milp_assignment': np.float64(0.6620976201926531), 'r2_refit_milp_assignment': 0.9940253553348696, 'weight_mismatch_refit_milp_assignment': np.float64(1.3432869946485826), 'refit-weight_mismatch_refit_milp_assignment': np.float64(0.0), 'rand_score_refit_milp_assignment': 1.0, 'label_mismatch_refit_milp_assignment': np.float64(0.0), 'mse_greedy': np.float64(4.8089934898923685), 'r2_greedy': np.float64(0.9566045452773683), 'weight_mismatch_greedy': np.float64(9.430989443534056), 'refit-weight_mismatch_greedy': np.float64(8.902986073000866), 'rand_score_greedy': np.float64(0.8104068857589984), 'label_mismatch_greedy': np.float64(0.21944444444444447), 'mse_greedy_sem': np.float64(1.7354217236480334), 'r2_greedy_sem': np.float64(0.015660119938096566), 'weight_mismatch_greedy_sem': np.float64(2.662543570063839), 'refit-weight_mismatch_greedy_sem': np.float64(2.7384564687979225), 'rand_score_greedy_sem': np.float64(0.02732230042950722), 'label_mismatch_greedy_sem': np.float64(0.03986861137335367), 'mse_ground_truth': np.float64(0.90948805876057), 'r2_ground_truth': np.float64(0.9919886686980003), 'weight_mismatch_ground_truth': 0, 'rand_score_ground_truth': 1, 'label_mismatch_ground_truth': 0, 'mse_baseline_sklearn': np.float64(110.37820297932691), 'r2_baseline_sklearn': np.float64(0.0039678115966717), 'mse_milp_val': np.float64(1.5109869209487403), 'r2_milp_val': 0.9871499424911744, 'label_mismatch_milp_val': np.float64(0.0625), 'mse_refit_milp_assignment_val': np.float64(1.5128584108452496), 'r2_refit_milp_assignment_val': 0.9871340265673076, 'label_mismatch_refit_milp_assignment_val': np.float64(0.0625), 'mse_greedy_val': np.float64(11.461368463764888), 'label_mismatch_greedy_val': np.float64(0.19166666666666665), 'mse_greedy_val_sem': np.float64(4.240777376009138), 'label_mismatch_greedy_val_sem': np.float64(0.041956230674330845), 'r2_greedy_val': np.float64(0.9025277837635128), 'r2_greedy_val_sem': np.float64(0.036065324198589085), 'mse_refit_ground_truth_assignment_val': np.float64(1.5128584108452496), 'r2_refit_ground_truth_assignment_val': 0.9871340265673076, 'label_mismatch_refit_ground_truth_assignment_val': np.float64(0.0625), 'mse_ground_truth_val': np.float64(1.5010460922938085), 'r2_ground_truth_val': 0.9872344834081936, 'label_mismatch_ground_truth_val': np.float64(0.0625), 'mse_baseline_sklearn_val': np.float64(117.58495155274458), 'r2_baseline_sklearn_val': 8.955288298917452e-06}
