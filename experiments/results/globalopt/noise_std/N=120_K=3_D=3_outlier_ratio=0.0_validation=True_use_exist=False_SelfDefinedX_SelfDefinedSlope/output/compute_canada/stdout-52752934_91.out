==================== Evaluating with noise_std = 0.3 in Dataset 1 with random state = 9 ====================
ODS is enabled
mse 0.09507576433569932
Splitting data into training and validation set
Not whitening the data...
Set parameter TokenServer to value "license1.computecanada.ca"
Set parameter Threads to value 16
Read parameters from file gurobi.env
Set parameter MIPGap to value 0.05
Set parameter TimeLimit to value 36000
Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (linux64 - "AlmaLinux 9.3 (Shamrock Pampas Cat)")

CPU model: Intel(R) Xeon(R) Platinum 8160 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 48 physical cores, 48 logical processors, using up to 16 threads

Optimize a model with 72 rows, 312 columns and 216 nonzeros
Model fingerprint: 0x8f1df02f
Model has 84 quadratic objective terms
Model has 216 general constraints
Variable types: 96 continuous, 216 integer (216 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [0e+00, 0e+00]
  QObjective range [2e-02, 2e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
  GenCon rhs range [2e-01, 2e+01]
  GenCon coe range [6e-03, 5e+00]
Presolve added 216 rows and 204 columns
Presolve time: 0.03s
Presolved: 288 rows, 516 columns, 1512 nonzeros
Presolved model has 216 SOS constraint(s)
Presolved model has 84 quadratic objective terms
Variable types: 300 continuous, 216 integer (216 binary)

Root relaxation: objective 0.000000e+00, 577 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    0.00000    0   72          -    0.00000      -     -    0s
H    0     0                    8027.1712411    0.00000   100%     -    0s
H    0     0                    7354.4382273    0.00000   100%     -    0s
     0     0    0.18396    0   71 7354.43823    0.18396   100%     -    0s
     0     2    0.18396    0   71 7354.43823    0.18396   100%     -    0s
H   32    48                    7312.3352566    0.18396   100%   2.4    0s
H   35    48                    6913.1086957    0.18396   100%   2.5    0s
H   38    48                    6798.7989759    0.18396   100%   2.5    0s
H   41    48                    6371.0365858    0.18396   100%   2.6    0s
H   79    96                    6075.6785641    0.18396   100%   2.4    0s
H  437   487                    5170.2249704    0.18396   100%   2.5    0s
H  438   487                    4247.6222971    0.18396   100%   2.5    0s
H 1302  1431                    3183.7983595    0.22331   100%   2.5    0s
H 1304  1431                    2806.8323176    0.22331   100%   2.5    0s
H 1322  1431                    1887.2861281    0.22331   100%   2.5    0s
H 1375  1431                    1487.8020209    0.22331   100%   2.5    0s
H 2486  2511                    1319.1311150    0.22331   100%   2.4    0s
H 2488  2511                    1011.0797711    0.22331   100%   2.4    0s
H 2489  2511                    1002.6195215    0.22331   100%   2.4    0s
H 2491  2511                     997.0967536    0.22331   100%   2.4    0s
H 2558  3017                     809.0538421    0.22331   100%   2.4    0s
H 2561  2989                     490.6055891    0.22331   100%   2.4    0s
H 2562  2987                     478.6810788    0.22331   100%   2.4    0s
H 2658  2979                     456.4781036    0.22331   100%   2.3    0s
H 2782  2963                     395.0636193    0.22331   100%   2.3    0s
H 2786  2957                     381.0612402    0.22331   100%   2.3    0s
H 3677  3339                     379.4620743    0.22331   100%   2.3    0s
H 3979  3307                     354.5303658    0.22331   100%   2.3    0s
H 4732  3899                     352.5596110    0.28991   100%   2.2    0s
H 5302  3806                     352.4847068    0.28991   100%   2.4    0s
H 5375  3673                     324.6440235    0.28991   100%   2.4    0s
H 5456  3573                     290.1726652    0.28991   100%   2.4    0s
H 6501  4010                     284.2641870    0.28991   100%   2.4    0s
H 6503  3850                     283.7379601    0.28991   100%   2.4    0s
H 6518  3670                     249.6712017    0.28991   100%   2.4    0s
H 6565  3786                     248.7862275    0.28991   100%   2.4    0s
H 7630  4051                     240.5737197    0.28991   100%   2.4    1s
H25265 11538                     234.1149243    0.65831   100%   2.1    1s
H48244 24394                     234.0769128    0.86364   100%   2.1    2s
H55628 28091                     233.8451206    0.92376   100%   2.1    2s
 113096 58469     cutoff   67       233.84512    1.20700  99.5%   2.0    5s
H130418 59616                     159.7011929    1.26765  99.2%   2.0    5s
H130421 58971                     154.2017181    1.26765  99.2%   2.0    5s
H131815 55618                     127.4142580    1.26765  99.0%   2.0    5s
H131828 55493                     126.2233212    1.26765  99.0%   2.0    5s
H131831 54709                     119.6631749    1.26765  98.9%   2.0    5s
H134019 51640                      84.3247865    1.26765  98.5%   2.0    5s
H137404 51783                      80.2262871    1.28047  98.4%   2.0    5s
H137424 49732                      70.9912570    1.28047  98.2%   2.0    5s
H174461 46732                      19.0218475    1.40930  92.6%   2.0    6s
H330261 104192                      18.7710076    2.08746  88.9%   2.0    9s
H330263 60167                       7.6260324    2.08746  72.6%   2.0    9s
 330279 60286     cutoff   79         7.62603    2.08746  72.6%   2.0   10s
 585257 101281     cutoff   73         7.62603    3.64080  52.3%   1.9   15s
 845054 91059    5.07518   45   69    7.62603    5.06714  33.6%   1.8   20s

Explored 1081459 nodes (1876038 simplex iterations) in 24.67 seconds (18.72 work units)
Thread count was 16 (of 48 available processors)

Solution count 10: 7.62603 18.771 19.0218 ... 154.202

Optimal solution found (tolerance 5.00e-02)
Best objective 7.626032428846e+00, best bound 7.253353210579e+00, gap 4.8869%
Optimal solution found.
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
Cluster Assignments from Gurobi MIQP using MSE

Cluster 0 weights w_0^* (including bias) in original space:
[-10.04242454  -1.32963572  -1.64004672  -1.00530793]

Cluster 1 weights w_1^* (including bias) in original space:
[9.97210777 0.0417818  0.12120725 0.21256932]

Cluster 2 weights w_2^* (including bias) in original space:
[0.99779814 1.67695362 1.5941649  0.87070841]
############################################################################

Ridge Regression using scikit-learn:
Optimal weights w* in X Space (including bias):
[ 0.36538474  0.0010831  -0.00052723 -0.00053088]

Mean Squared Error on training data (scikit-learn) with lambda = 0.1:
111.48789694918989
Cluster assignments:  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
-----------------------------------
Regression weights for cluster 0: y = -1.3296x_0 + -1.64x_1 + -1.0053x_2 + -10.0424
Regression weights for cluster 0 after refit: y = -1.3263x_1 + -1.6361x_2 + -0.9984x_3 + -10.0622
-----------------------------------
Regression weights for cluster 1: y = 0.0418x_0 + 0.1212x_1 + 0.2126x_2 + 9.9721
Regression weights for cluster 1 after refit: y = 0.0379x_1 + 0.1183x_2 + 0.2099x_3 + 9.9854
-----------------------------------
Regression weights for cluster 2: y = 1.677x_0 + 1.5942x_1 + 0.8707x_2 + 0.9978
Regression weights for cluster 2 after refit: y = 1.6772x_1 + 1.5947x_2 + 0.8703x_3 + 0.9979
{'time_milp': 25.00345492362976, 'time_greedy': np.float64(0.546766173839569), 'time_refit_milp_assignment': 28.165684461593628, 'mse_refit_ground_truth_assignment': np.float64(0.0762998967216262), 'r2_refit_ground_truth_assignment': 0.9993356128061572, 'weight_mismatch_refit_ground_truth_assignment': np.float64(0.3874116984016556), 'refit-weight_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'rand_score_refit_ground_truth_assignment': 1.0, 'label_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'mse_milp': np.float64(0.07634344421580326), 'r2_milp': 0.9993352336130167, 'weight_mismatch_milp': np.float64(0.37124070934102393), 'refit-weight_mismatch_milp': np.float64(0.03672989367199139), 'rand_score_milp': 1.0, 'label_mismatch_milp': np.float64(0.0), 'mse_refit_milp_assignment': np.float64(0.0762998967216262), 'r2_refit_milp_assignment': 0.9993356128061572, 'weight_mismatch_refit_milp_assignment': np.float64(0.3874116984016556), 'refit-weight_mismatch_refit_milp_assignment': np.float64(0.0), 'rand_score_refit_milp_assignment': 1.0, 'label_mismatch_refit_milp_assignment': np.float64(0.0), 'mse_greedy': np.float64(3.816764365356055), 'r2_greedy': np.float64(0.9667652319961875), 'weight_mismatch_greedy': np.float64(11.390883360929426), 'refit-weight_mismatch_greedy': np.float64(11.251168748793337), 'rand_score_greedy': np.float64(0.8479264475743349), 'label_mismatch_greedy': np.float64(0.18888888888888886), 'mse_greedy_sem': np.float64(1.4137151362266986), 'r2_greedy_sem': np.float64(0.01231003281272498), 'weight_mismatch_greedy_sem': np.float64(3.924781438773985), 'refit-weight_mismatch_greedy_sem': np.float64(3.9557931539119013), 'rand_score_greedy_sem': np.float64(0.031239249786539882), 'label_mismatch_greedy_sem': np.float64(0.041914467813462336), 'mse_ground_truth': np.float64(0.09507576433569932), 'r2_ground_truth': np.float64(0.9991445979407676), 'weight_mismatch_ground_truth': 0, 'rand_score_ground_truth': 1, 'label_mismatch_ground_truth': 0, 'mse_baseline_sklearn': np.float64(111.48789694918989), 'r2_baseline_sklearn': np.float64(0.029210599435675833), 'mse_milp_val': np.float64(0.10056734125687605), 'r2_milp_val': 0.9990443019412723, 'label_mismatch_milp_val': np.float64(0.0), 'mse_refit_milp_assignment_val': np.float64(0.10150958603406017), 'r2_refit_milp_assignment_val': 0.9990353477271791, 'label_mismatch_refit_milp_assignment_val': np.float64(0.0), 'mse_greedy_val': np.float64(6.086452339222033), 'label_mismatch_greedy_val': np.float64(0.18854166666666666), 'mse_greedy_val_sem': np.float64(2.4118130500105703), 'label_mismatch_greedy_val_sem': np.float64(0.0447712621823158), 'r2_greedy_val': np.float64(0.9421600430871919), 'r2_greedy_val_sem': np.float64(0.022919618049977202), 'mse_refit_ground_truth_assignment_val': np.float64(0.10150958603406017), 'r2_refit_ground_truth_assignment_val': 0.9990353477271791, 'label_mismatch_refit_ground_truth_assignment_val': np.float64(0.0), 'mse_ground_truth_val': np.float64(0.09631597685177384), 'r2_ground_truth_val': 0.9990847029368451, 'label_mismatch_ground_truth_val': np.float64(0.0), 'mse_baseline_sklearn_val': np.float64(105.86013270721084), 'r2_baseline_sklearn_val': -0.005995804010820116}
