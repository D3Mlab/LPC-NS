==================== Evaluating with noise_std = 2 in Dataset 1 with random state = 2 ====================
ODS is enabled
mse 4.491299055607753
Splitting data into training and validation set
Not whitening the data...
Set parameter TokenServer to value "license1.computecanada.ca"
Set parameter Threads to value 16
Read parameters from file gurobi.env
Set parameter MIPGap to value 0.05
Set parameter TimeLimit to value 36000
using MSE:
Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (linux64 - "AlmaLinux 9.3 (Shamrock Pampas Cat)")

CPU model: Intel(R) Xeon(R) Platinum 8160 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 48 physical cores, 48 logical processors, using up to 16 threads

Optimize a model with 72 rows, 288 columns and 216 nonzeros
Model fingerprint: 0x046992e1
Model has 72 quadratic objective terms
Model has 216 general constraints
Variable types: 72 continuous, 216 integer (216 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [0e+00, 0e+00]
  QObjective range [2e+00, 2e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
  GenCon rhs range [1e+00, 2e+01]
  GenCon coe range [5e-05, 1e+01]
Presolve added 216 rows and 216 columns
Presolve time: 0.02s
Presolved: 288 rows, 504 columns, 16200 nonzeros
Presolved model has 216 SOS constraint(s)
Presolved model has 72 quadratic objective terms
Variable types: 288 continuous, 216 integer (216 binary)
Found heuristic solution: objective 8444.7616586
Found heuristic solution: objective 7585.0939241

Root relaxation: objective 0.000000e+00, 655 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    0.00000    0   88 7585.09392    0.00000   100%     -    0s
H    0     0                    6473.6613697    0.00000   100%     -    0s
H    0     0                    2819.5344586    0.00000   100%     -    0s
     0     0    0.00000    0   87 2819.53446    0.00000   100%     -    0s
     0     2    0.00000    0   87 2819.53446    0.00000   100%     -    0s
H  195   213                    2311.5840180    4.84701   100%  36.4    0s
H  205   213                    1882.8022338    4.84701   100%  36.8    0s
H  214   229                    1595.8734247    4.84701   100%  36.9    1s
H  215   229                    1343.2365490    4.84701   100%  37.1    1s
H  227   229                    1264.6156560    4.84701   100%  39.1    1s
H 1294  1221                    1220.7384518    4.84701   100%  28.1    1s
H 1298  1197                    1156.8210364    4.84701   100%  28.2    1s
H 1299  1195                    1151.7966265    4.84701   100%  28.2    1s
H 1300  1190                    1128.0137390    4.84701   100%  28.2    1s
H 3454  2561                    1098.8985965    4.84701   100%  30.3    4s
H 3456  2457                     960.0661032    4.84701  99.5%  30.3    4s
H 3457  2358                     929.0031124    4.84701  99.5%  30.3    4s
H 6090  2130                     528.3659935    4.84701  99.1%  29.5    4s
* 6460  2002             111     525.5403769    4.84701  99.1%  29.4    4s
  8247  2258   26.83917   24   75  525.54038   20.11622  96.2%  30.1    5s
*11674  3617             122     515.8948624   32.28098  93.7%  27.9    5s
*11704  3530             119     493.5416556   32.28098  93.5%  27.8    5s
*20211  6832             123     481.4812690   51.12498  89.4%  24.1    6s
H30085  9851                     444.2447851   61.51162  86.2%  21.4    7s
H30088  9548                     432.9498886   61.51162  85.8%  21.4    7s
*31333  8405             119     384.1266452   61.51162  84.0%  21.0    7s
*41251 10579             122     345.8984271   72.44660  79.1%  19.4    8s
 59607 15883  112.70769   53   68  345.89843   86.99584  74.8%  17.4   10s
*84888 21849             115     336.0670821  103.84475  69.1%  15.8   11s
H86327 20767                     321.5634889  104.92179  67.4%  15.8   12s
H86366 19973                     313.8885596  105.12570  66.5%  15.8   12s
 122540 29171  255.02662   57   60  313.88856  122.30337  61.0%  14.2   15s
H161906 34820                     296.2508223  136.13895  54.0%  13.1   19s
 162760 35287  246.46112   80   43  296.25082  136.20402  54.0%  13.1   20s
 228784 48182     cutoff   53       296.25082  154.98257  47.7%  11.9   25s
H265340 55106                     295.6763806  162.59967  45.0%  11.4   28s
H265417 54845                     294.5273078  162.59967  44.8%  11.4   28s
 283978 58675  242.20806   78   46  294.52731  166.18719  43.6%  11.2   30s
 352290 72016  275.68617   62   49  294.52731  176.80627  40.0%  10.5   36s
 401208 81094     cutoff   59       294.52731  183.19009  37.8%  10.2   40s
H428981 83953                     289.3202651  186.68288  35.5%  10.0   42s
 457702 88823     cutoff   52       289.32027  189.88932  34.4%   9.9   45s
*515602 95261             120     285.2836040  195.92170  31.3%   9.6   49s
 516080 95446  272.27244   55   57  285.28360  195.97108  31.3%   9.6   52s
 544093 100042     cutoff   61       285.28360  198.56700  30.4%   9.4   55s
 594239 108112     cutoff   65       285.28360  202.41057  29.0%   9.2   63s
 611585 111555  259.13926   63   46  285.28360  203.55378  28.6%   9.2   65s
 655359 118986  257.53582   91   34  285.28360  206.13848  27.7%   9.0   70s
 719757 129635     cutoff   53       285.28360  209.37060  26.6%   8.8   75s
 775429 138758     cutoff   89       285.28360  211.88815  25.7%   8.6   80s
 838017 148490  217.00332   85   39  285.28360  214.34288  24.9%   8.4   85s
 874677 153764     cutoff   92       285.28360  215.77639  24.4%   8.3   90s
 933260 162563  251.77775   97   30  285.28360  217.84009  23.6%   8.2   95s
 983357 169912  263.30947   88   32  285.28360  219.38734  23.1%   8.1  101s
 1031152 176962  237.39170   92   35  285.28360  220.74426  22.6%   8.0  105s
 1067916 182212  241.86123   96   26  285.28360  221.67389  22.3%   7.9  110s
 1133645 191235     cutoff   99       285.28360  223.27860  21.7%   7.8  115s
 1190841 199152  247.59124  106   10  285.28360  224.55664  21.3%   7.7  120s
 1257747 208074  270.66633   90   31  285.28360  225.90053  20.8%   7.6  125s
 1304923 214207  257.00446   87   31  285.28360  226.78502  20.5%   7.5  130s
 1334556 217875     cutoff  104       285.28360  227.35071  20.3%   7.5  135s
 1400913 226141     cutoff   85       285.28360  228.47176  19.9%   7.4  140s
 1468950 234384  262.05219   88   33  285.28360  229.57277  19.5%   7.3  145s
 1536760 242239     cutoff  101       285.28360  230.57985  19.2%   7.2  150s
 1578364 246442  252.83414   55   50  285.28360  231.20553  19.0%   7.1  155s
 1638714 252585  278.84563   74   39  285.28360  232.07075  18.7%   7.1  160s
 1694684 258680     cutoff  103       285.28360  232.81788  18.4%   7.0  165s
 1757198 264926  241.12658   95   34  285.28360  233.60877  18.1%   7.0  170s
 1795530 268675  257.52410   98   20  285.28360  234.08353  17.9%   6.9  175s
 1858763 274777  268.95963   84   40  285.28360  234.83495  17.7%   6.9  180s
 1928285 281127  259.83644   94   29  285.28360  235.62490  17.4%   6.8  185s
 1962061 283980     cutoff  103       285.28360  236.00313  17.3%   6.8  190s
 2033029 290323     cutoff   98       285.28360  236.70321  17.0%   6.7  195s
 2078029 294092  273.76884   65   50  285.28360  237.15273  16.9%   6.7  200s
 2110779 296618  266.69728  103   10  285.28360  237.50393  16.7%   6.6  205s
 2178596 301697  256.61963   53   58  285.28360  238.15362  16.5%   6.6  210s
 2212065 304227  244.59592   89   36  285.28360  238.48834  16.4%   6.6  215s
 2280357 308821  241.03777  100   18  285.28360  239.11248  16.2%   6.5  220s
 2348541 313324     cutoff  103       285.28360  239.71118  16.0%   6.5  225s
 2398185 316755  248.26621  105   10  285.28360  240.15559  15.8%   6.4  230s
 2424185 318391  250.35387   91   34  285.28360  240.36281  15.7%   6.4  235s
 2494941 322885     cutoff  101       285.28360  240.96745  15.5%   6.4  240s
 2560717 326532     cutoff  105       285.28360  241.50360  15.3%   6.3  245s
 2612461 329070     cutoff  103       285.28360  241.93269  15.2%   6.3  250s
 2664441 331458  253.44362   98   19  285.28360  242.34834  15.1%   6.3  255s
 2709632 333864     cutoff   98       285.28360  242.70362  14.9%   6.3  260s
 2768305 336502  259.57214   87   35  285.28360  243.14566  14.8%   6.2  267s
 2804856 338128     cutoff  100       285.28360  243.40954  14.7%   6.2  270s
 2874078 340671  244.98776   93   33  285.28360  243.93380  14.5%   6.2  275s
 2921620 342623     cutoff   92       285.28360  244.28725  14.4%   6.2  280s
 2976896 344404     cutoff   66       285.28360  244.68500  14.2%   6.1  285s
 3023207 346042     cutoff  108       285.28360  245.00724  14.1%   6.1  290s
 3091808 347770  273.00189   87   33  285.28360  245.48767  13.9%   6.1  295s
 3139166 348810  270.04779  101   10  285.28360  245.82691  13.8%   6.1  300s
 3172626 349439  254.14325   90   27  285.28360  246.05958  13.7%   6.0  305s
 3239164 351090     cutoff  102       285.28360  246.51388  13.6%   6.0  310s
 3306674 352055  248.08114   79   38  285.28360  246.97115  13.4%   6.0  315s
 3370658 353032     cutoff  114       285.28360  247.40010  13.3%   6.0  322s
 3407127 353386     cutoff  102       285.28360  247.64706  13.2%   6.0  325s
 3469581 353934     cutoff   99       285.28360  248.05512  13.0%   5.9  330s
 3529878 354305     cutoff   57       285.28360  248.45526  12.9%   5.9  335s
 3580864 354831     cutoff  100       285.28360  248.77438  12.8%   5.9  340s
 3639610 354719     cutoff  103       285.28360  249.16017  12.7%   5.9  345s
H3662266 346314                     281.5388129  249.30553  11.4%   5.9  348s
 3685716 345442     cutoff   95       281.53881  249.49292  11.4%   5.9  350s
 3737821 343383     cutoff  103       281.53881  249.87806  11.2%   5.9  356s
 3792389 340625     cutoff  113       281.53881  250.29429  11.1%   5.8  360s
 3859858 337006     cutoff  107       281.53881  250.79428  10.9%   5.8  365s
 3913563 333905     cutoff   98       281.53881  251.19657  10.8%   5.8  372s
 3955199 331449  263.31899   91   25  281.53881  251.51803  10.7%   5.8  375s
 4017423 327361  260.49896  105   17  281.53881  251.98150  10.5%   5.8  381s
 4068471 323527     cutoff  102       281.53881  252.37636  10.4%   5.8  385s
 4105220 320882     cutoff   93       281.53881  252.65930  10.3%   5.8  390s
 4164448 315974     cutoff  101       281.53881  253.12067  10.1%   5.7  395s
 4214451 312120  262.59194   93   28  281.53881  253.49050  10.0%   5.7  401s
 4256330 308241     cutoff  110       281.53881  253.82307  9.84%   5.7  405s
 4326281 301508  278.42861   62   58  281.53881  254.36808  9.65%   5.7  410s
 4393603 294690  260.36697  102   18  281.53881  254.89933  9.46%   5.7  415s
 4434205 290219     cutoff   77       281.53881  255.23680  9.34%   5.7  420s
 4485611 284505     cutoff  111       281.53881  255.67018  9.19%   5.7  426s
 4536031 278532  259.70677   91   29  281.53881  256.08775  9.04%   5.7  430s
 4605993 269345     cutoff  106       281.53881  256.69313  8.82%   5.7  435s
 4647969 263626     cutoff   99       281.53881  257.05980  8.69%   5.6  440s
 4716139 253925  257.70214   76   44  281.53881  257.67481  8.48%   5.6  445s
 4748259 248744  258.37127   95   31  281.53881  257.98249  8.37%   5.6  450s
 4815200 237294  263.57417   91   28  281.53881  258.65614  8.13%   5.6  455s
 4851087 230676  276.08587  103   15  281.53881  259.02930  8.00%   5.6  460s
 4918156 217599     cutoff   87       281.53881  259.77818  7.73%   5.6  465s
 4972731 206553  266.08142   95   27  281.53881  260.41460  7.50%   5.6  470s
 5007841 198551  262.15518   98   28  281.53881  260.86487  7.34%   5.6  475s
 5075898 182234     cutoff   95       281.53881  261.77534  7.02%   5.6  480s
 5125333 169479     cutoff   99       281.53881  262.51344  6.76%   5.6  486s
 5173768 155378     cutoff   91       281.53881  263.35635  6.46%   5.6  490s
 5234955 135402     cutoff   58       281.53881  264.57981  6.02%   5.6  498s
 5253715 128624     cutoff  105       281.53881  265.00370  5.87%   5.6  500s
 5318951 103710     cutoff   56       281.53881  266.68007  5.28%   5.5  505s

Explored 5343490 nodes (29586440 simplex iterations) in 506.73 seconds (472.27 work units)
Thread count was 16 (of 48 available processors)

Solution count 10: 281.539 285.284 289.32 ... 345.898

Optimal solution found (tolerance 5.00e-02)
Best objective 2.815388128553e+02, best bound 2.674787997852e+02, gap 4.9940%

Gurobi MIQP converged to an optimal solution.
Cluster Assignments from Gurobi MIQP using MSE
############################################################################

Ridge Regression using scikit-learn:
Optimal weights w* in X Space (including bias):
[ 4.63481013e-01 -7.64684518e-05  5.59961905e-04  2.74730280e-05]

Mean Squared Error on training data (scikit-learn) with lambda = 0.1:
114.11027491265307
Cluster assignments:  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 2 2 2 1 1 2 1 2 2 2 2 2
 1 1 2 2 2 2 2 1 2 2 2 1 1 1 2 1 1 1 2 2 1 1 2 2 1 1 1 1 2 1 1 1 2 1 1]
-----------------------------------
Regression weights for cluster 0: y = -1.0738x_0 + -1.1876x_1 + -1.0818x_2 + -11.073
Regression weights for cluster 0 after refit: y = -1.0682x_1 + -1.184x_2 + -1.0762x_3 + -11.091
-----------------------------------
Regression weights for cluster 1: y = -1.2798x_0 + -0.0945x_1 + -0.2912x_2 + 11.4763
Regression weights for cluster 1 after refit: y = -1.2848x_1 + -0.1004x_2 + -0.2937x_3 + 11.4938
-----------------------------------
Regression weights for cluster 2: y = 1.2196x_0 + 2.8413x_1 + 0.1511x_2 + 1.4647
Regression weights for cluster 2 after refit: y = 1.2195x_1 + 2.842x_2 + 0.1505x_3 + 1.4651
{'time_milp': 507.47183895111084, 'time_greedy': np.float64(0.5367294788360596), 'time_refit_milp_assignment': 510.6353409290314, 'mse_refit_ground_truth_assignment': np.float64(3.2696178774945825), 'r2_refit_ground_truth_assignment': 0.9714917808446522, 'weight_mismatch_refit_ground_truth_assignment': np.float64(2.985082210290976), 'refit-weight_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'rand_score_refit_ground_truth_assignment': 1.0, 'label_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'mse_milp': np.float64(2.6432540268479183), 'r2_milp': 0.9769531278871102, 'weight_mismatch_milp': np.float64(4.935933942333365), 'refit-weight_mismatch_milp': np.float64(2.647028820701182), 'rand_score_milp': np.float64(0.8137715179968701), 'label_mismatch_milp': np.float64(0.19444444444444445), 'mse_refit_milp_assignment': np.float64(2.643199201300776), 'r2_refit_milp_assignment': 0.9769536059181131, 'weight_mismatch_refit_milp_assignment': np.float64(4.9724786915897266), 'refit-weight_mismatch_refit_milp_assignment': np.float64(2.6414452910908537), 'rand_score_refit_milp_assignment': np.float64(0.8137715179968701), 'label_mismatch_refit_milp_assignment': np.float64(0.19444444444444445), 'mse_greedy': np.float64(6.34649670098083), 'r2_greedy': np.float64(0.9446640783115325), 'weight_mismatch_greedy': np.float64(13.009187657350665), 'refit-weight_mismatch_greedy': np.float64(12.062608828975574), 'rand_score_greedy': np.float64(0.7640453834115806), 'label_mismatch_greedy': np.float64(0.2951388888888889), 'mse_greedy_sem': np.float64(1.4085589241205467), 'r2_greedy_sem': np.float64(0.012281406576116318), 'weight_mismatch_greedy_sem': np.float64(2.677693982063704), 'refit-weight_mismatch_greedy_sem': np.float64(2.8958979299478766), 'rand_score_greedy_sem': np.float64(0.018923569911334977), 'label_mismatch_greedy_sem': np.float64(0.03147659885023615), 'mse_ground_truth': np.float64(4.491299055607753), 'r2_ground_truth': np.float64(0.9621183805746369), 'weight_mismatch_ground_truth': 0, 'rand_score_ground_truth': 1, 'label_mismatch_ground_truth': 0, 'mse_baseline_sklearn': np.float64(114.11027491265307), 'r2_baseline_sklearn': np.float64(0.005057824194537153), 'mse_milp_val': np.float64(6.737638792234222), 'r2_milp_val': 0.945821742175329, 'label_mismatch_milp_val': np.float64(0.08333333333333333), 'mse_refit_milp_assignment_val': np.float64(6.734636820151863), 'r2_refit_milp_assignment_val': 0.9458458814357548, 'label_mismatch_refit_milp_assignment_val': np.float64(0.08333333333333333), 'mse_greedy_val': np.float64(19.57847945558084), 'label_mismatch_greedy_val': np.float64(0.23333333333333334), 'mse_greedy_val_sem': np.float64(4.647542479283785), 'label_mismatch_greedy_val_sem': np.float64(0.03507640990984885), 'r2_greedy_val': np.float64(0.8425668189600675), 'r2_greedy_val_sem': np.float64(0.03737151284868021), 'mse_refit_ground_truth_assignment_val': np.float64(6.190306468580276), 'r2_refit_ground_truth_assignment_val': 0.9502229148503734, 'label_mismatch_refit_ground_truth_assignment_val': np.float64(0.125), 'mse_ground_truth_val': np.float64(6.260156012358711), 'r2_ground_truth_val': 0.9496612452939517, 'label_mismatch_ground_truth_val': np.float64(0.125), 'mse_baseline_sklearn_val': np.float64(124.37140436751243), 'r2_baseline_sklearn_val': -8.715510335055576e-05}
