==================== Evaluating with noise_std = 2.6 in Dataset 1 with random state = 8 ====================
ODS is enabled
mse 8.494496632181276
Splitting data into training and validation set
Not whitening the data...
Set parameter TokenServer to value "license1.computecanada.ca"
Set parameter Threads to value 16
Read parameters from file gurobi.env
Set parameter MIPGap to value 0.05
Set parameter TimeLimit to value 36000
using MSE:
Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (linux64 - "AlmaLinux 9.3 (Shamrock Pampas Cat)")

CPU model: Intel(R) Xeon(R) Platinum 8260 CPU @ 2.40GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 48 physical cores, 48 logical processors, using up to 16 threads

Optimize a model with 72 rows, 288 columns and 216 nonzeros
Model fingerprint: 0x021a4665
Model has 72 quadratic objective terms
Model has 216 general constraints
Variable types: 72 continuous, 216 integer (216 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [0e+00, 0e+00]
  QObjective range [2e+00, 2e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
  GenCon rhs range [2e-01, 2e+01]
  GenCon coe range [2e-04, 1e+01]
Presolve added 216 rows and 216 columns
Presolve time: 0.01s
Presolved: 288 rows, 504 columns, 16200 nonzeros
Presolved model has 216 SOS constraint(s)
Presolved model has 72 quadratic objective terms
Variable types: 288 continuous, 216 integer (216 binary)
Found heuristic solution: objective 8501.4164015
Found heuristic solution: objective 7342.9174670

Root relaxation: objective 0.000000e+00, 655 iterations, 0.01 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    0.00000    0   82 7342.91747    0.00000   100%     -    0s
H    0     0                    6424.3162180    0.00000   100%     -    0s
H    0     0                    6400.9483699    0.00000   100%     -    0s
H    0     0                    4082.4794664    0.00000   100%     -    0s
     0     0    0.00000    0   84 4082.47947    0.00000   100%     -    0s
     0     2    0.00000    0   84 4082.47947    0.00000   100%     -    0s
H   42    48                    3928.9786473    0.00000   100%  34.5    0s
H  144   159                    2527.0219065    0.00000   100%  39.4    0s
H  196   223                    2103.1735171    0.00000   100%  38.0    0s
H  207   223                    1968.3048221    0.00000   100%  37.5    0s
H  208   223                    1745.1440440    0.00000   100%  37.6    0s
H  623   639                    1639.8084289    0.00000   100%  28.8    1s
H  631   639                    1584.1039950    0.00000   100%  28.8    1s
H  633   639                    1136.4296963    0.00000   100%  29.0    1s
H 2588  2163                    1065.8297068    0.00000   100%  27.1    4s
H 2649  2102                    1049.3911549    0.00000   100%  27.6    4s
H 2789  2085                     887.5783068    0.00000   100%  28.5    5s
H 3068  2179                     824.2593953    0.00000   100%  29.2    6s
 10007  4665  404.16981   30   74  824.25940    0.56835   100%  30.8   12s
H10069  4649                     801.1058346    0.56835   100%  30.9   12s
H11898  5747                     783.3480696    2.71522   100%  31.3   12s
H14556  6575                     754.3974400    6.34638  99.2%  31.5   13s
 28923 12235  703.92958   24   76  754.39744   26.13040  96.5%  31.8   15s
 82233 28961  689.50120   40   70  754.39744   98.22876  87.0%  29.6   20s
H111746 37117                     730.5613572  126.46107  82.7%  28.8   22s
*127631 37321             114     659.2794643  139.31815  78.9%  28.4   24s
 135811 39568     cutoff   45       659.27946  144.82204  78.0%  28.2   25s
 193766 53344     cutoff   46       659.27946  186.26393  71.7%  26.7   30s
*200867 54352             113     653.5861527  189.70159  71.0%  26.5   30s
*200870 48204             114     601.7442161  189.70159  68.5%  26.5   30s
 238918 55850  507.12841   30   71  601.74422  210.58051  65.0%  25.6   36s
H238939 52825                     580.1869302  210.58051  63.7%  25.6   36s
H238941 48317                     551.3910886  210.58051  61.8%  25.6   36s
 279385 56949  501.73017   32   75  551.39109  228.21761  58.6%  24.5   40s
H316863 63476                     545.8812193  239.92744  56.0%  23.5   43s
H316869 63270                     544.8448102  239.92744  56.0%  23.5   43s
H316878 61333                     533.5879341  239.92744  55.0%  23.5   43s
 318676 61893     cutoff   38       533.58793  240.53190  54.9%  23.5   45s
H318722 61459                     531.0159127  240.53190  54.7%  23.5   45s
 372830 73359  473.54108   56   55  531.01591  254.63075  52.0%  22.2   50s
 426504 87309  298.88422   45   68  531.01591  264.75572  50.1%  21.0   55s
 482075 102292  451.99471   57   44  531.01591  273.25733  48.5%  20.0   64s
 483218 102730     cutoff   33       531.01591  273.38120  48.5%  20.0   65s
 551760 121602  445.75278   40   65  531.01591  281.25746  47.0%  19.0   70s
 623323 140181     cutoff   39       531.01591  287.73140  45.8%  18.0   75s
H684346 151241                     515.3132419  293.23631  43.1%  17.3   79s
 688473 152462  306.87065   33   75  515.31324  293.47248  43.0%  17.3   80s
 746778 165637  392.79436   54   60  515.31324  298.18041  42.1%  16.7   85s
 799485 176791     cutoff   37       515.31324  302.08260  41.4%  16.2   90s
H799487 166186                     493.4498254  302.08260  38.8%  16.2   90s
 858143 177578  465.28390   66   40  493.44983  306.72376  37.8%  15.7   95s
 932928 191294  357.64832   23   72  493.44983  312.17834  36.7%  15.2  100s
H981920 196351                     488.7123144  315.57665  35.4%  14.9  104s
 989431 198058  407.39650   67   42  488.71231  316.05801  35.3%  14.8  105s
 1061878 210409  436.54725   67   41  488.71231  320.97903  34.3%  14.4  110s
 1121468 220352     cutoff   41       488.71231  324.80253  33.5%  14.1  116s
 1180649 229923  424.10823   58   54  488.71231  328.26150  32.8%  13.9  120s
 1236179 238410  471.33450   62   45  488.71231  331.52067  32.2%  13.6  126s
 1287004 246300     cutoff   67       488.71231  334.34049  31.6%  13.4  130s
 1354624 256928  343.44563   52   54  488.71231  337.95785  30.8%  13.2  135s
 1407279 264465     cutoff   75       488.71231  340.68256  30.3%  13.0  140s
 1473956 274027     cutoff   34       488.71231  343.95194  29.6%  12.8  147s
 1512131 279157  387.49282   69   47  488.71231  345.74106  29.3%  12.7  150s
 1583698 289427  448.87204   75   42  488.71231  348.76936  28.6%  12.5  157s
 1626612 295540     cutoff   72       488.71231  350.59033  28.3%  12.3  160s
 1698223 305758  426.17917   62   51  488.71231  353.51148  27.7%  12.2  165s
 1755491 313301     cutoff   48       488.71231  355.62445  27.2%  12.0  170s
 1798102 318950     cutoff   69       488.71231  357.20079  26.9%  11.9  175s
 1860854 327761  362.75430   49   52  488.71231  359.25668  26.5%  11.8  180s
 1922642 336199     cutoff   81       488.71231  361.26518  26.1%  11.6  185s
 1980279 343432  407.93765   68   47  488.71231  363.09656  25.7%  11.5  190s
 2044892 351616  420.61354   73   46  488.71231  364.98144  25.3%  11.4  195s
 2117105 359730     cutoff   87       488.71231  367.07585  24.9%  11.3  200s
 2140498 362289  379.87301   36   71  488.71231  367.73070  24.8%  11.2  205s
 2216489 371011  442.64514   57   56  488.71231  369.84695  24.3%  11.1  210s
 2288507 378897  471.49831   78   33  488.71231  371.81412  23.9%  11.0  215s
 2348037 384638     cutoff   63       488.71231  373.41479  23.6%  10.9  220s
 2374296 387387  423.44186   68   51  488.71231  374.09646  23.5%  10.8  225s
 2437466 394051  481.83209   86   30  488.71231  375.71425  23.1%  10.7  230s
 2511940 401766     cutoff   80       488.71231  377.54662  22.7%  10.6  235s
 2549981 405506  484.75134   71   39  488.71231  378.43765  22.6%  10.6  243s
 2565662 406895  434.11695   69   44  488.71231  378.81232  22.5%  10.5  245s
 2636581 412765     cutoff   79       488.71231  380.49084  22.1%  10.5  250s
 2709689 418595     cutoff   79       488.71231  382.17851  21.8%  10.4  255s
 2785474 424889  401.99034   58   59  488.71231  383.85689  21.5%  10.3  260s
 2856057 430534     cutoff   76       488.71231  385.46696  21.1%  10.2  265s
 2929704 435630     cutoff   89       488.71231  387.11336  20.8%  10.1  270s
 2985646 439745  485.10301   71   41  488.71231  388.31350  20.5%  10.1  275s
 3043531 443904     cutoff   62       488.71231  389.50003  20.3%  10.0  280s
 3084300 446854  445.06348   84   34  488.71231  390.35299  20.1%  10.0  285s
 3159105 451562     cutoff   44       488.71231  391.88932  19.8%   9.9  290s
 3216839 455081     cutoff   54       488.71231  393.07430  19.6%   9.8  295s
 3281590 459517     cutoff   54       488.71231  394.28273  19.3%   9.8  301s
 3333582 462242     cutoff   74       488.71231  395.28265  19.1%   9.7  305s
 3379594 464376     cutoff   99       488.71231  396.18041  18.9%   9.7  310s
 3440436 467628  442.05057   75   46  488.71231  397.34467  18.7%   9.6  315s
 3481211 469463  471.42949   84   25  488.71231  398.12463  18.5%   9.6  320s
 3544438 472510     cutoff   88       488.71231  399.31556  18.3%   9.5  325s
 3613982 476030     cutoff   60       488.71231  400.55111  18.0%   9.5  330s
 3661450 477937     cutoff   86       488.71231  401.41372  17.9%   9.5  335s
 3733084 480628  465.51350   78   39  488.71231  402.58701  17.6%   9.4  340s
 3772090 482216  425.31046   78   42  488.71231  403.23195  17.5%   9.4  345s
 3841415 484995  451.79740   72   42  488.71231  404.35537  17.3%   9.3  350s
 3883435 486938     cutoff  101       488.71231  405.06807  17.1%   9.3  355s
 3954895 489744  462.51562   79   32  488.71231  406.18389  16.9%   9.2  360s
 4026418 491687     cutoff   63       488.71231  407.34102  16.7%   9.2  365s
 4095477 493943  463.01968   86   25  488.71231  408.44251  16.4%   9.1  373s
 4124946 494887     cutoff   91       488.71231  408.89685  16.3%   9.1  375s
 4194261 496244  468.66773   79   38  488.71231  409.96654  16.1%   9.1  380s
 4269423 498260     cutoff   82       488.71231  411.11597  15.9%   9.0  385s
 4305217 499040     cutoff   79       488.71231  411.65162  15.8%   9.0  390s
 4372924 500198     cutoff   77       488.71231  412.65474  15.6%   9.0  395s
 4441255 501283  453.58575   89   22  488.71231  413.61984  15.4%   8.9  400s
 4478313 501696     cutoff   75       488.71231  414.16588  15.3%   8.9  405s
 4550008 502919  467.20723   69   46  488.71231  415.17538  15.0%   8.9  410s
 4571283 503052  418.12458   79   34  488.71231  415.45772  15.0%   8.9  415s
 4642534 503977  456.61002   93   21  488.71231  416.42890  14.8%   8.8  420s
 4682421 504489  444.44223   50   68  488.71231  416.96004  14.7%   8.8  425s
 4754193 504640  484.03583   76   34  488.71231  417.95868  14.5%   8.8  430s
 4810817 505079  472.45607   82   39  488.71231  418.69839  14.3%   8.7  437s
 4851385 505303  466.75326   73   38  488.71231  419.22967  14.2%   8.7  440s
 4924278 505352     cutoff   87       488.71231  420.18347  14.0%   8.7  445s
 4992631 504919  434.49346   39   64  488.71231  421.06136  13.8%   8.6  450s
 5001916 504804  471.88334   85   24  488.71231  421.18485  13.8%   8.6  455s
 5075053 504241     cutoff   76       488.71231  422.12764  13.6%   8.6  460s
 5146773 503730  432.68230   80   38  488.71231  423.01941  13.4%   8.6  465s
 5216522 502597     cutoff   91       488.71231  423.92557  13.3%   8.5  470s
 5255287 501734     cutoff   80       488.71231  424.39122  13.2%   8.5  475s
 5324238 500695     cutoff   87       488.71231  425.28145  13.0%   8.5  480s
 5384247 500086     cutoff   76       488.71231  425.98778  12.8%   8.5  485s
 5394032 499741  444.65341   76   38  488.71231  426.11936  12.8%   8.5  490s
 5411664 497946  436.81813   59   50  488.71231  426.41752  12.7%   8.4  495s
 5487781 488785  440.22828   91   36  488.71231  427.78870  12.5%   8.4  500s
 5534675 480182     cutoff   62       488.71231  428.75435  12.3%   8.4  505s
 5609113 465663     cutoff   61       488.71231  430.28568  12.0%   8.3  510s
 5665784 454201     cutoff   85       488.71231  431.44542  11.7%   8.3  515s
 5717658 443249  443.50618   78   33  488.71231  432.55741  11.5%   8.3  520s
 5778939 429624  438.53559   75   40  488.71231  433.93809  11.2%   8.3  528s
 5808697 421509     cutoff   44       488.71231  434.67898  11.1%   8.2  530s
 5887655 399937  439.46396   65   45  488.71231  436.71500  10.6%   8.2  535s
 5953521 381387  452.09068   91   26  488.71231  438.49532  10.3%   8.2  540s
 5997664 368048     cutoff   89       488.71231  439.73793  10.0%   8.2  545s
 6072532 344590     cutoff   62       488.71231  441.92847  9.57%   8.1  552s
 6109172 332330  446.32790   61   59  488.71231  443.07164  9.34%   8.1  555s
 6187830 305259     cutoff   76       488.71231  445.71894  8.80%   8.1  560s
 6265592 276888  471.06567   55   62  488.71231  448.39872  8.25%   8.0  565s
 6290139 268362     cutoff   77       488.71231  449.24956  8.07%   8.0  571s
 6349460 245899  459.39802   70   34  488.71231  451.42998  7.63%   8.0  575s
 6427664 215264     cutoff   75       488.71231  454.44360  7.01%   7.9  580s
 6505761 182727  466.72579   69   39  488.71231  457.66356  6.35%   7.9  585s
 6584879 147825     cutoff   96       488.71231  461.31372  5.61%   7.9  590s
 6629329 127347  465.56913   90   31  488.71231  463.55358  5.15%   7.8  595s

Explored 6643534 nodes (51974489 simplex iterations) in 595.85 seconds (604.09 work units)
Thread count was 16 (of 48 available processors)

Solution count 10: 488.712 493.45 515.313 ... 601.744

Optimal solution found (tolerance 5.00e-02)
Best objective 4.887123143742e+02, best bound 4.643760182820e+02, gap 4.9797%

Gurobi MIQP converged to an optimal solution.
Cluster Assignments from Gurobi MIQP using MSE
############################################################################

Ridge Regression using scikit-learn:
Optimal weights w* in X Space (including bias):
[ 7.16056034e-01 -2.84339265e-05 -4.58776487e-05  3.11718473e-04]

Mean Squared Error on training data (scikit-learn) with lambda = 0.1:
115.34594584972436
Cluster assignments:  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 1 1 2 2 2 1 2 2 2
 1 2 2 2 2 2 2 2 1 2 1 1 1 1 1 1 2 1 1 1 2 1 1 1 1 1 1 1 2 1 2 1 2 2 1]
-----------------------------------
Regression weights for cluster 0: y = -1.9487x_0 + -1.598x_1 + 0.0902x_2 + -10.1333
Regression weights for cluster 0 after refit: y = -1.9455x_1 + -1.5944x_2 + 0.0959x_3 + -10.1492
-----------------------------------
Regression weights for cluster 1: y = -0.6793x_0 + 2.16x_1 + 0.4039x_2 + 9.1276
Regression weights for cluster 1 after refit: y = -0.6835x_1 + 2.1553x_2 + 0.401x_3 + 9.142
-----------------------------------
Regression weights for cluster 2: y = 2.3107x_0 + 1.4116x_1 + 0.7029x_2 + 0.5717
Regression weights for cluster 2 after refit: y = 2.3115x_1 + 1.4124x_2 + 0.7031x_3 + 0.5704
{'time_milp': 596.6888220310211, 'time_greedy': np.float64(0.4817036509513855), 'time_refit_milp_assignment': 599.4148964881897, 'mse_refit_ground_truth_assignment': np.float64(6.705515706471235), 'r2_refit_ground_truth_assignment': 0.9419513905100092, 'weight_mismatch_refit_ground_truth_assignment': np.float64(4.36871157871246), 'refit-weight_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'rand_score_refit_ground_truth_assignment': 1.0, 'label_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'mse_milp': np.float64(6.006993191188294), 'r2_milp': 0.9479983915886129, 'weight_mismatch_milp': np.float64(4.5827406088970335), 'refit-weight_mismatch_milp': np.float64(1.2703027345397548), 'rand_score_milp': np.float64(0.8309859154929577), 'label_mismatch_milp': np.float64(0.16666666666666666), 'mse_refit_milp_assignment': np.float64(6.006954983182262), 'r2_refit_milp_assignment': 0.9479987223493953, 'weight_mismatch_refit_milp_assignment': np.float64(4.580796945116335), 'refit-weight_mismatch_refit_milp_assignment': np.float64(1.2403753026618782), 'rand_score_refit_milp_assignment': np.float64(0.8309859154929577), 'label_mismatch_refit_milp_assignment': np.float64(0.16666666666666666), 'mse_greedy': np.float64(9.475920449025782), 'r2_greedy': np.float64(0.9179684263250818), 'weight_mismatch_greedy': np.float64(18.427162559778118), 'refit-weight_mismatch_greedy': np.float64(16.569214208715092), 'rand_score_greedy': np.float64(0.7430164319248826), 'label_mismatch_greedy': np.float64(0.30416666666666664), 'mse_greedy_sem': np.float64(1.1120443369527016), 'r2_greedy_sem': np.float64(0.009626795354311948), 'weight_mismatch_greedy_sem': np.float64(2.794449220979037), 'refit-weight_mismatch_greedy_sem': np.float64(2.9445219978940016), 'rand_score_greedy_sem': np.float64(0.02105537613755561), 'label_mismatch_greedy_sem': np.float64(0.031217900993342738), 'mse_ground_truth': np.float64(8.494496632181276), 'r2_ground_truth': np.float64(0.9291394551847586), 'weight_mismatch_ground_truth': 0, 'rand_score_ground_truth': 1, 'label_mismatch_ground_truth': 0, 'mse_baseline_sklearn': np.float64(115.34594584972436), 'r2_baseline_sklearn': np.float64(0.0014680361687114951), 'mse_milp_val': np.float64(9.999826265984813), 'r2_milp_val': 0.9208689215545973, 'label_mismatch_milp_val': np.float64(0.16666666666666666), 'mse_refit_milp_assignment_val': np.float64(10.00654922904676), 'r2_refit_milp_assignment_val': 0.9208157210985803, 'label_mismatch_refit_milp_assignment_val': np.float64(0.16666666666666666), 'mse_greedy_val': np.float64(33.26490105332309), 'label_mismatch_greedy_val': np.float64(0.3270833333333334), 'mse_greedy_val_sem': np.float64(7.395017108683122), 'label_mismatch_greedy_val_sem': np.float64(0.02954408070457367), 'r2_greedy_val': np.float64(0.7367666772688841), 'r2_greedy_val_sem': np.float64(0.0585185845600958), 'mse_refit_ground_truth_assignment_val': np.float64(11.534738803337547), 'r2_refit_ground_truth_assignment_val': 0.9087227820948304, 'label_mismatch_refit_ground_truth_assignment_val': np.float64(0.20833333333333334), 'mse_ground_truth_val': np.float64(7.671487229530413), 'r2_ground_truth_val': 0.9392936395487375, 'label_mismatch_ground_truth_val': np.float64(0.20833333333333334), 'mse_baseline_sklearn_val': np.float64(126.44888939861447), 'r2_baseline_sklearn_val': -0.0006210828254213929}
