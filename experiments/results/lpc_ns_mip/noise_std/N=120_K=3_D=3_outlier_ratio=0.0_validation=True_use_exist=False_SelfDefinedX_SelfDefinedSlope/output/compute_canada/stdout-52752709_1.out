==================== Evaluating with noise_std = 0.3 in Dataset 1 with random state = 42 ====================
ODS is enabled
mse 0.07698092769608018
Splitting data into training and validation set
Not whitening the data...
Set parameter TokenServer to value "license1.computecanada.ca"
Set parameter Threads to value 16
Read parameters from file gurobi.env
Set parameter MIPGap to value 0.05
Set parameter TimeLimit to value 36000
using MSE:
Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (linux64 - "AlmaLinux 9.3 (Shamrock Pampas Cat)")

CPU model: Intel(R) Xeon(R) Platinum 8160 CPU @ 2.10GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 48 physical cores, 48 logical processors, using up to 16 threads

Optimize a model with 72 rows, 288 columns and 216 nonzeros
Model fingerprint: 0x1e0fbdea
Model has 72 quadratic objective terms
Model has 216 general constraints
Variable types: 72 continuous, 216 integer (216 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [0e+00, 0e+00]
  QObjective range [2e+00, 2e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
  GenCon rhs range [3e-01, 2e+01]
  GenCon coe range [3e-04, 1e+01]
Presolve added 216 rows and 216 columns
Presolve time: 0.04s
Presolved: 288 rows, 504 columns, 16200 nonzeros
Presolved model has 216 SOS constraint(s)
Presolved model has 72 quadratic objective terms
Variable types: 288 continuous, 216 integer (216 binary)
Found heuristic solution: objective 9979.0267059
Found heuristic solution: objective 7353.5796040

Root relaxation: objective 0.000000e+00, 635 iterations, 0.02 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    0.00000    0   81 7353.57960    0.00000   100%     -    0s
H    0     0                    6716.8614121    0.00000   100%     -    0s
H    0     0                    6555.9021834    0.00000   100%     -    0s
H    0     0                    5310.9644436    0.00000   100%     -    0s
     0     0    0.00000    0   80 5310.96444    0.00000   100%     -    0s
H    0     0                    4759.9460367    0.00000   100%     -    0s
     0     2    0.00000    0   80 4759.94604    0.00000   100%     -    0s
H   32    48                    4592.9146582    0.00000   100%  42.8    0s
H   36    48                    3647.1073059    0.00000   100%  39.4    0s
H   42    48                    2949.6536517    0.00000   100%  34.4    0s
H   44    48                    2512.1168399    0.00000   100%  33.1    0s
H  111   128                    2289.7550656    0.00000   100%  42.2    0s
H  115   128                    2254.6714013    0.00000   100%  42.8    0s
H  135   158                    2134.0981724    0.00000   100%  42.9    0s
H  189   235                    1919.2312052    0.00000   100%  40.0    0s
H  302   304                    1898.5480295    0.00000   100%  42.4    1s
H  805   814                    1599.7295390    0.00000   100%  37.0    1s
H  806   814                    1572.7645100    0.00000   100%  36.9    1s
H  807   814                    1428.2860920    0.00000   100%  36.9    1s
H  812   814                    1401.2099835    0.00000   100%  36.7    1s
H 1998  1738                    1306.2091386    0.00000   100%  27.8    1s
H 2004  1488                    1076.4882112    0.00000   100%  27.8    1s
H 2005  1371                     943.4846048    0.00000   100%  27.8    1s
H 2013  1129                     693.7024309    0.00000   100%  27.8    4s
  2625  1475  611.10278   36    6  693.70243    0.00000   100%  28.6    7s
H 2756  1519                     690.2560819    0.00000   100%  29.5    7s
H 3252  1725                     676.6960326    0.00000   100%  31.2    8s
H 3268  1670                     647.0109328    0.00000   100%  31.2    8s
H 3278  1602                     589.7374007    0.00000   100%  31.1    8s
 12901  5193  253.80809   33   64  589.73740   33.29064  94.4%  27.3   10s
*28407  9631             124     520.0862804   67.68890  87.0%  25.7   11s
H44139 15087                     500.9541374   79.98580  84.0%  23.9   13s
H44142 14639                     487.6110351   79.98580  83.6%  23.9   13s
 58185 19124  166.89571   35   70  487.61104   89.03712  81.7%  22.6   15s
*60330 18519             119     458.1311387   89.73846  80.4%  22.3   15s
H61680 16029                     415.3395749   90.00706  78.3%  22.2   16s
H61986 14477                     389.8444131   90.00706  76.9%  22.1   16s
 96128 25120  210.35577   42   54  389.84441  107.92301  72.3%  19.8   20s
 155311 42031  208.31651   35   67  389.84441  124.61207  68.0%  17.3   25s
 213065 58037     cutoff   35       389.84441  135.57374  65.2%  15.9   30s
 255565 69195  191.01259   56   63  389.84441  142.35225  63.5%  15.2   36s
H256076 67111                     372.3940791  142.46850  61.7%  15.2   37s
 285708 75232  235.66556   54   57  372.39408  146.28174  60.7%  14.7   40s
 340811 89625     cutoff   73       372.39408  152.92804  58.9%  14.1   45s
H341040 88567                     366.4709501  152.98070  58.3%  14.1   45s
 392493 101664  266.42287   73   51  366.47095  158.85296  56.7%  13.7   50s
 449109 115544  301.39630   52   65  366.47095  164.56955  55.1%  13.2   55s
 462876 118886     cutoff   51       366.47095  165.77467  54.8%  13.1   60s
 523753 133489  234.26196   63   56  366.47095  170.74900  53.4%  12.8   65s
 588693 148991  228.34096   50   62  366.47095  175.52727  52.1%  12.4   70s
H636294 159061                     364.3083246  178.67212  51.0%  12.2   74s
 640150 160470  300.03792   59   57  364.30832  178.97724  50.9%  12.2   75s
 703629 174537     cutoff   50       364.30832  183.29506  49.7%  12.0   80s
 746479 184454     cutoff   44       364.30832  185.94978  49.0%  11.8   85s
 801470 197120  222.27680   53   59  364.30832  189.18214  48.1%  11.7   90s
 867323 212177  312.08352   66   54  364.30832  192.91487  47.0%  11.5   95s
 916424 222721     cutoff   59       364.30832  195.46289  46.3%  11.4  100s
 979857 235906     cutoff   96       364.30832  198.54772  45.5%  11.2  105s
 1039931 248135     cutoff   79       364.30832  201.30539  44.7%  11.1  110s
 1086909 257586     cutoff   59       364.30832  203.37082  44.2%  11.0  115s
 1148039 269738  317.86519   48   63  364.30832  205.98032  43.5%  10.9  120s
 1203537 280228  250.97334   57   61  364.30832  208.31773  42.8%  10.8  125s
 1268336 292435     cutoff   88       364.30832  210.99908  42.1%  10.7  130s
 1277995 294154     cutoff   67       364.30832  211.38306  42.0%  10.7  136s
 1319087 301837  353.19343   37   73  364.30832  213.07647  41.5%  10.7  140s
 1385903 314016  286.02758   49   59  364.30832  215.63317  40.8%  10.6  145s
 1452225 325780     cutoff   72       364.30832  218.02055  40.2%  10.5  150s
 1514752 336505     cutoff   76       364.30832  220.20740  39.6%  10.4  155s
 1527686 338574     cutoff   26       364.30832  220.64385  39.4%  10.4  161s
 1574792 346557     cutoff   59       364.30832  222.24838  39.0%  10.4  165s
 1641224 356964  330.99724   56   50  364.30832  224.66971  38.3%  10.3  170s
 1704925 366845     cutoff   56       364.30832  226.82134  37.7%  10.3  175s
 1770008 376086  258.06990   66   57  364.30832  229.03166  37.1%  10.2  180s
 1814204 382460     cutoff   71       364.30832  230.57117  36.7%  10.2  185s
 1871517 390122  358.52722   78   40  364.30832  232.44929  36.2%  10.1  190s
 1922028 396457  301.85835   73   46  364.30832  234.07931  35.7%  10.1  200s
 1981882 404730     cutoff   57       364.30832  235.94776  35.2%  10.0  205s
 2045600 412717     cutoff   80       364.30832  237.93013  34.7%  10.0  210s
 2110839 420790  304.14074   71   50  364.30832  239.86862  34.2%   9.9  215s
 2177600 428750     cutoff   60       364.30832  241.92514  33.6%   9.9  220s
 2230099 434704  311.62767   59   59  364.30832  243.38748  33.2%   9.9  225s
 2277385 439819  305.53290   74   47  364.30832  244.72126  32.8%   9.8  230s
 2343175 446579  345.92805   80   42  364.30832  246.59536  32.3%   9.8  235s
 2409951 452531  322.52587   70   53  364.30832  248.44739  31.8%   9.8  240s
 2428144 454379  322.56249   70   42  364.30832  248.93972  31.7%   9.7  247s
 2458719 457346  279.49234   34   72  364.30832  249.76705  31.4%   9.7  250s
 2525775 463232  296.45435   63   48  364.30832  251.62839  30.9%   9.7  255s
 2591232 468861     cutoff   54       364.30832  253.37137  30.5%   9.6  260s
 2655518 474393     cutoff   76       364.30832  255.02011  30.0%   9.6  265s
 2717607 478939     cutoff   78       364.30832  256.60456  29.6%   9.6  270s
 2778656 482380  328.19049   66   54  364.30832  258.27494  29.1%   9.5  275s
 2827571 485959  347.57441   58   54  364.30832  259.53213  28.8%   9.5  280s
 2883603 489980  289.00317   54   58  364.30832  260.90738  28.4%   9.5  285s
 2915068 491271     cutoff   67       364.30832  261.70012  28.2%   9.5  292s
 2946081 492952  322.25247   57   64  364.30832  262.45677  28.0%   9.4  295s
 3012106 496437     cutoff   66       364.30832  264.07494  27.5%   9.4  300s
 3077993 499174     cutoff   50       364.30832  265.71368  27.1%   9.4  305s
 3143026 502288     cutoff   50       364.30832  267.20388  26.7%   9.3  310s
 3177290 503722  287.98981   63   55  364.30832  268.00143  26.4%   9.3  315s
 3244700 505920     cutoff   70       364.30832  269.57890  26.0%   9.3  320s
 3299720 507315     cutoff   65       364.30832  270.84645  25.7%   9.2  325s
 3360302 508514  295.23448   63   56  364.30832  272.23579  25.3%   9.2  330s
 3407198 510203     cutoff   86       364.30832  273.26421  25.0%   9.2  335s
 3460133 510966     cutoff   63       364.30832  274.42787  24.7%   9.2  340s
 3523333 511446  288.52075   54   59  364.30832  275.85397  24.3%   9.1  345s
 3580301 511727     cutoff   58       364.30832  277.16844  23.9%   9.1  350s
 3627833 512032  302.21564   67   52  364.30832  278.19090  23.6%   9.1  355s
 3693497 512668  316.04456   65   56  364.30832  279.58020  23.3%   9.0  360s
 3741562 512426  310.69652   51   59  364.30832  280.59925  23.0%   9.0  365s
 3808999 511898     cutoff   55       364.30832  282.04408  22.6%   9.0  370s
 3858097 510689  283.76090   57   62  364.30832  283.13750  22.3%   9.0  375s
 3922796 509301  349.38567   59   54  364.30832  284.52249  21.9%   8.9  380s
 3931334 509282     cutoff   58       364.30832  284.68714  21.9%   8.9  385s
 3991917 507805     cutoff   71       364.30832  285.95061  21.5%   8.9  390s
 4058788 505279  317.22283   54   59  364.30832  287.32528  21.1%   8.9  395s
 4120840 503309     cutoff   85       364.30832  288.56915  20.8%   8.8  400s
 4144862 502643  334.02199   67   51  364.30832  289.04658  20.7%   8.8  407s
 4185131 500795     cutoff   76       364.30832  289.88082  20.4%   8.8  410s
 4252332 498028  314.81961   71   55  364.30832  291.21633  20.1%   8.8  415s
 4316451 494996     cutoff   62       364.30832  292.50296  19.7%   8.8  420s
 4364894 492353     cutoff   66       364.30832  293.45577  19.4%   8.7  425s
 4423276 488905     cutoff   46       364.30832  294.63114  19.1%   8.7  430s
 4469897 486409  326.24213   78   38  364.30832  295.51546  18.9%   8.7  435s
 4534319 482337     cutoff   58       364.30832  296.78032  18.5%   8.7  440s
 4600571 477326     cutoff   65       364.30832  298.08800  18.2%   8.6  445s
 4653821 473643  357.21029   65   47  364.30832  299.09299  17.9%   8.6  450s
 4704030 469697  310.41067   59   56  364.30832  300.04035  17.6%   8.6  455s
 4770988 463563  323.07481   71   50  364.30832  301.32143  17.3%   8.6  460s
 4818965 458494     cutoff   57       364.30832  302.25860  17.0%   8.5  465s
 4879369 452568     cutoff   67       364.30832  303.43757  16.7%   8.5  470s
 4936619 446636  305.31334   80   39  364.30832  304.53215  16.4%   8.5  475s
 4992737 440368  341.83444   52   50  364.30832  305.62610  16.1%   8.5  480s
 5005056 439183     cutoff   53       364.30832  305.84862  16.0%   8.5  487s
 5044401 435038     cutoff   78       364.30832  306.56872  15.8%   8.4  490s
 5062116 433093     cutoff   91       364.30832  306.91412  15.8%   8.4  496s
 5098712 428640     cutoff   61       364.30832  307.62687  15.6%   8.4  500s
 5164864 420176  354.24366   62   48  364.30832  308.93131  15.2%   8.4  505s
 5227861 411547     cutoff   67       364.30832  310.16465  14.9%   8.4  510s
 5295774 402147     cutoff   77       364.30832  311.53443  14.5%   8.3  515s
 5360649 393362     cutoff   67       364.30832  312.81546  14.1%   8.3  520s
 5419678 384201     cutoff   58       364.30832  314.03398  13.8%   8.3  525s
 5465269 377103  353.85953   90   32  364.30832  314.97416  13.5%   8.3  530s
 5529817 366020     cutoff   78       364.30832  316.34120  13.2%   8.2  535s
 5581548 357284     cutoff   62       364.30832  317.44380  12.9%   8.2  540s
 5636336 346964     cutoff   57       364.30832  318.64733  12.5%   8.2  545s
 5693124 336820     cutoff   68       364.30832  319.87103  12.2%   8.2  550s
 5748867 325949     cutoff   71       364.30832  321.11292  11.9%   8.1  555s
 5764925 323004  341.65437   69   55  364.30832  321.46904  11.8%   8.1  560s
 5829102 310061     cutoff   79       364.30832  322.93356  11.4%   8.1  565s
 5894768 296136     cutoff   69       364.30832  324.50308  10.9%   8.1  570s
 5905363 293648     cutoff   78       364.30832  324.76254  10.9%   8.1  576s
 5949458 283660  330.57885   62   53  364.30832  325.83386  10.6%   8.1  580s
 6012652 268902     cutoff   89       364.30832  327.40132  10.1%   8.0  585s
 6080039 252563  354.50414   93   27  364.30832  329.12658  9.66%   8.0  590s
 6143408 235327     cutoff  108       364.30832  330.85044  9.18%   8.0  595s
 6195467 220062     cutoff   29       364.30832  332.35457  8.77%   8.0  600s
 6246520 204681     cutoff  103       364.30832  333.84944  8.36%   7.9  605s
 6313774 182702     cutoff   62       364.30832  335.96783  7.78%   7.9  610s
 6331312 176842     cutoff   64       364.30832  336.57078  7.61%   7.9  616s
 6370008 162532  346.58851   97   27  364.30832  337.93266  7.24%   7.9  620s
 6439209 135157  355.82963   85   43  364.30832  340.65386  6.49%   7.8  625s
 6511063 103483     cutoff   67       364.30832  344.01289  5.57%   7.8  630s

Explored 6548318 nodes (50936610 simplex iterations) in 632.64 seconds (573.06 work units)
Thread count was 16 (of 48 available processors)

Solution count 10: 364.308 366.471 372.394 ... 589.737

Optimal solution found (tolerance 5.00e-02)
Best objective 3.643083245871e+02, best bound 3.461525793695e+02, gap 4.9836%

Gurobi MIQP converged to an optimal solution.
Cluster Assignments from Gurobi MIQP using MSE
############################################################################

Ridge Regression using scikit-learn:
Optimal weights w* in X Space (including bias):
[0.83194794 0.00159574 0.00090693 0.00123203]

Mean Squared Error on training data (scikit-learn) with lambda = 0.1:
105.6000807124676
Cluster assignments:  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 1 2 2 2 1 2
 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 2 1 1 2 1 1 1 1 1 2 1 1 1 1 2 1 1 1 1]
-----------------------------------
Regression weights for cluster 0: y = -1.3514x_0 + -1.6746x_1 + -1.0077x_2 + -10.079
Regression weights for cluster 0 after refit: y = -1.3418x_1 + -1.6674x_2 + -1.0035x_3 + -10.1017
-----------------------------------
Regression weights for cluster 1: y = 0.6718x_0 + 0.2534x_1 + 0.2413x_2 + 9.3674
Regression weights for cluster 1 after refit: y = 0.6708x_1 + 0.2474x_2 + 0.2385x_3 + 9.3823
-----------------------------------
Regression weights for cluster 2: y = 1.8482x_0 + 1.9431x_1 + 0.7865x_2 + 0.9866
Regression weights for cluster 2 after refit: y = 1.8486x_1 + 1.9437x_2 + 0.786x_3 + 0.9865
{'time_milp': 633.5334105491638, 'time_greedy': np.float64(0.5485929131507874), 'time_refit_milp_assignment': 636.5863769054413, 'mse_refit_ground_truth_assignment': np.float64(0.06577748460807453), 'r2_refit_ground_truth_assignment': 0.9994187982773075, 'weight_mismatch_refit_ground_truth_assignment': np.float64(0.25612143069461385), 'refit-weight_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'rand_score_refit_ground_truth_assignment': 1.0, 'label_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'mse_milp': np.float64(0.2991505029953304), 'r2_milp': 0.9973567431360262, 'weight_mismatch_milp': np.float64(1.473786126198472), 'refit-weight_mismatch_milp': np.float64(1.4267810742164082), 'rand_score_milp': np.float64(0.9014084507042254), 'label_mismatch_milp': np.float64(0.08333333333333333), 'mse_refit_milp_assignment': np.float64(0.2991037949657868), 'r2_refit_milp_assignment': 0.9973571558424013, 'weight_mismatch_refit_milp_assignment': np.float64(1.4817046741400701), 'refit-weight_mismatch_refit_milp_assignment': np.float64(1.3888507807547275), 'rand_score_refit_milp_assignment': np.float64(0.9014084507042254), 'label_mismatch_refit_milp_assignment': np.float64(0.08333333333333333), 'mse_greedy': np.float64(6.0820178606059745), 'r2_greedy': np.float64(0.9462600420327245), 'weight_mismatch_greedy': np.float64(16.120635129810605), 'refit-weight_mismatch_greedy': np.float64(16.086485988932537), 'rand_score_greedy': np.float64(0.7899061032863851), 'label_mismatch_greedy': np.float64(0.2548611111111111), 'mse_greedy_sem': np.float64(1.5865581125321662), 'r2_greedy_sem': np.float64(0.01401863135463129), 'weight_mismatch_greedy_sem': np.float64(3.0242876558441716), 'refit-weight_mismatch_greedy_sem': np.float64(3.058637737073958), 'rand_score_greedy_sem': np.float64(0.03297166736272621), 'label_mismatch_greedy_sem': np.float64(0.04082078764586237), 'mse_ground_truth': np.float64(0.07698092769608018), 'r2_ground_truth': np.float64(0.9993132840449835), 'weight_mismatch_ground_truth': 0, 'rand_score_ground_truth': 1, 'label_mismatch_ground_truth': 0, 'mse_baseline_sklearn': np.float64(105.6000807124676), 'r2_baseline_sklearn': np.float64(0.06693074093283169), 'mse_milp_val': np.float64(0.4071775533810302), 'r2_milp_val': 0.9963104713944984, 'label_mismatch_milp_val': np.float64(0.041666666666666664), 'mse_refit_milp_assignment_val': np.float64(0.4078623926694469), 'r2_refit_milp_assignment_val': 0.9963042659096336, 'label_mismatch_refit_milp_assignment_val': np.float64(0.041666666666666664), 'mse_greedy_val': np.float64(13.561326667057552), 'label_mismatch_greedy_val': np.float64(0.23958333333333334), 'mse_greedy_val_sem': np.float64(3.8211543286155996), 'label_mismatch_greedy_val_sem': np.float64(0.04090588345421219), 'r2_greedy_val': np.float64(0.8771177284916808), 'r2_greedy_val_sem': np.float64(0.03462435019906589), 'mse_refit_ground_truth_assignment_val': np.float64(0.09057018248201067), 'r2_refit_ground_truth_assignment_val': 0.999179322935908, 'label_mismatch_refit_ground_truth_assignment_val': np.float64(0.0), 'mse_ground_truth_val': np.float64(0.08643972864633735), 'r2_ground_truth_val': 0.9992167499194289, 'label_mismatch_ground_truth_val': np.float64(0.0), 'mse_baseline_sklearn_val': np.float64(110.5794112552547), 'r2_baseline_sklearn_val': -0.0019852460383658066}
