==================== Evaluating with noise_std = 2.3 in Dataset 1 with random state = 5 ====================
ODS is enabled
mse 5.16910935107816
Splitting data into training and validation set
Not whitening the data...
Set parameter TokenServer to value "license1.computecanada.ca"
Set parameter Threads to value 16
Read parameters from file gurobi.env
Set parameter MIPGap to value 0.05
Set parameter TimeLimit to value 36000
using MSE:
Gurobi Optimizer version 11.0.1 build v11.0.1rc0 (linux64 - "AlmaLinux 9.3 (Shamrock Pampas Cat)")

CPU model: Intel(R) Xeon(R) Platinum 8260 CPU @ 2.40GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 48 physical cores, 48 logical processors, using up to 16 threads

Optimize a model with 72 rows, 288 columns and 216 nonzeros
Model fingerprint: 0x414b6601
Model has 72 quadratic objective terms
Model has 216 general constraints
Variable types: 72 continuous, 216 integer (216 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [0e+00, 0e+00]
  QObjective range [2e+00, 2e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
  GenCon rhs range [1e+00, 2e+01]
  GenCon coe range [2e-05, 9e+00]
Presolve added 216 rows and 216 columns
Presolve time: 0.04s
Presolved: 288 rows, 504 columns, 16200 nonzeros
Presolved model has 216 SOS constraint(s)
Presolved model has 72 quadratic objective terms
Variable types: 288 continuous, 216 integer (216 binary)
Found heuristic solution: objective 11282.823445
Found heuristic solution: objective 7673.9489929

Root relaxation: objective 0.000000e+00, 643 iterations, 0.01 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0    0.00000    0   72 7673.94899    0.00000   100%     -    0s
     0     0    0.00000    0   74 7673.94899    0.00000   100%     -    0s
H    0     0                    5121.9464763    0.00000   100%     -    0s
     0     2    0.00000    0   74 5121.94648    0.00000   100%     -    0s
H   32    48                    4699.6380176    0.00000   100%  16.0    0s
H   34    48                    4527.9551549    0.00000   100%  15.5    0s
H   82    96                    3802.8830145    0.00000   100%  31.2    0s
H   97   128                    3392.0779430    0.00000   100%  31.1    0s
H  193   234                    3102.5928942    0.00000   100%  31.4    0s
H  226   234                    3041.5152051    0.00000   100%  33.0    0s
H  497   513                    2498.0982136    0.00000   100%  30.9    1s
H  499   513                    1630.5436479    0.00000   100%  30.8    1s
H  512   529                    1340.2460117    0.00000   100%  30.6    1s
H  521   529                    1164.4203429    0.00000   100%  30.3    1s
H 2889  2446                    1113.1053253    0.00000   100%  22.4    2s
H 3163  2513                    1060.8508524    0.00000   100%  24.8    3s
  7379  4031   93.85720   19   79 1060.85085    2.27951   100%  28.2    5s
*36052 16444             121    1017.8809339   97.91056  90.4%  28.3    7s
 57209 24840  703.20124   24   78 1017.88093  134.25826  86.8%  27.5   10s
H69304 28936                     978.9938497  148.73418  84.8%  27.1   11s
*78366 31218             110     933.6067666  157.67678  83.1%  26.6   11s
H80030 29189                     886.8397759  161.23968  81.8%  26.5   12s
 112191 41430  773.90477   31   68  886.83978  192.01474  78.3%  25.2   15s
H129032 47067                     882.1724472  203.69875  76.9%  24.6   16s
H129343 46667                     875.0395763  203.69875  76.7%  24.6   16s
H129552 42955                     821.8581682  203.69875  75.2%  24.6   16s
H130094 39071                     778.6273073  204.61856  73.7%  24.6   16s
H130217 32230                     706.2018097  204.88293  71.0%  24.6   16s
 157104 40520     cutoff   39       706.20181  224.92125  68.2%  23.8   20s
H189305 47164                     688.6190214  245.12968  64.4%  23.0   24s
 195793 49528  483.90443   26   80  688.61902  249.06658  63.8%  22.9   25s
 229639 59185  596.45770   51   60  688.61902  264.59323  61.6%  22.0   30s
 262265 68094  642.98954   58   56  688.61902  276.87121  59.8%  21.4   37s
H263137 64219                     657.1536698  276.90164  57.9%  21.4   37s
*293358 71118             107     650.2889347  286.89334  55.9%  20.8   39s
 295705 72373  458.67176   47   62  650.28893  287.81873  55.7%  20.8   40s
 361657 89745     cutoff   35       650.28893  305.76872  53.0%  19.7   45s
H390995 96848                     647.6413431  313.05968  51.7%  19.3   47s
 425179 105708  429.89116   39   67  647.64134  320.13743  50.6%  18.9   50s
 492026 122129  485.80478   52   59  647.64134  332.20922  48.7%  18.1   55s
H545861 132922                     635.4096836  340.14983  46.5%  17.6   59s
 545923 133203     cutoff   63       635.40968  340.16827  46.5%  17.6   61s
H546114 125881                     612.7157664  340.19945  44.5%  17.6   61s
 586481 134262  587.44884   88   38  612.71577  345.91310  43.5%  17.3   65s
 654869 148122  473.14809   40   64  612.71577  354.96961  42.1%  16.8   70s
 720521 160466  383.68983   39   66  612.71577  363.13701  40.7%  16.4   75s
 784303 172799     cutoff   64       612.71577  370.08343  39.6%  16.1   80s
 835324 182660     cutoff   45       612.71577  375.41908  38.7%  15.8   85s
 899070 194448  550.08670   57   46  612.71577  381.43978  37.7%  15.5   90s
 956513 204434     cutoff   43       612.71577  386.57884  36.9%  15.3   95s
 982719 208832     cutoff   49       612.71577  388.71181  36.6%  15.2  101s
 1027549 216712  513.57854   59   59  612.71577  392.36443  36.0%  15.1  105s
 1098938 229114  441.28097   62   52  612.71577  397.83978  35.1%  14.8  110s
 1168303 240887  566.84270   45   65  612.71577  402.97671  34.2%  14.6  115s
 1227133 250481  426.81062   55   59  612.71577  406.88300  33.6%  14.4  120s
 1290958 260540  608.36312   61   51  612.71577  411.00449  32.9%  14.2  125s
 1337410 268519     cutoff   41       612.71577  413.75659  32.5%  14.1  130s
 1407147 279175  461.26707   31   64  612.71577  417.81991  31.8%  13.9  135s
 1447539 285067  534.24900   74   46  612.71577  420.26610  31.4%  13.9  140s
 1519573 295892     cutoff   62       612.71577  424.23377  30.8%  13.7  145s
 1590633 307329  529.27452   63   43  612.71577  427.87824  30.2%  13.6  150s
 1635624 314456     cutoff   67       612.71577  430.09608  29.8%  13.5  155s
 1699001 324152     cutoff   77       612.71577  433.10055  29.3%  13.3  160s
 1764472 333757  515.05032   61   46  612.71577  436.25058  28.8%  13.2  166s
 1813921 340431     cutoff   53       612.71577  438.50711  28.4%  13.1  170s
 1880475 349493  561.85353   73   54  612.71577  441.29878  28.0%  13.0  175s
 1896499 351585  561.98421   47   59  612.71577  441.93706  27.9%  13.0  180s
 1966579 360106  538.03771   74   40  612.71577  444.88794  27.4%  12.9  185s
 2036589 368077  505.60086   59   55  612.71577  447.73561  26.9%  12.8  190s
 2101313 375328  519.68670   49   62  612.71577  450.32975  26.5%  12.7  195s
 2131723 378411  573.08873   52   54  612.71577  451.55123  26.3%  12.7  200s
 2204123 386008     cutoff   38       612.71577  454.36045  25.8%  12.6  205s
 2270417 392532     cutoff   82       612.71577  456.77309  25.5%  12.5  210s
 2325491 398001  574.84301   76   36  612.71577  458.73341  25.1%  12.4  215s
 2378690 403128     cutoff   72       612.71577  460.55396  24.8%  12.4  220s
 2439257 408543  565.20969   69   52  612.71577  462.66092  24.5%  12.3  225s
 2495452 413894  499.69169   36   76  612.71577  464.51189  24.2%  12.2  230s
 2544224 417995     cutoff   65       612.71577  466.23388  23.9%  12.2  235s
 2612361 424098     cutoff   68       612.71577  468.42211  23.5%  12.1  240s
 2669226 428922  603.81469   54   54  612.71577  470.30793  23.2%  12.0  245s
 2691884 430732  542.19098   52   65  612.71577  471.06367  23.1%  12.0  250s
 2765043 436993  574.16725   70   40  612.71577  473.36603  22.7%  11.9  255s
 2835614 441933  532.08745   58   58  612.71577  475.56195  22.4%  11.9  260s
H2836097 440890                     611.5145688  475.57610  22.2%  11.9  260s
 2894934 445365     cutoff   57       611.51457  477.35445  21.9%  11.8  265s
 2916079 447062     cutoff   56       611.51457  477.96821  21.8%  11.8  270s
 2989098 452131     cutoff   48       611.51457  480.10128  21.5%  11.7  275s
 3061034 456399     cutoff   62       611.51457  482.14603  21.2%  11.6  280s
 3121747 459944  515.25096   53   59  611.51457  483.85822  20.9%  11.6  287s
 3156752 462011     cutoff   81       611.51457  484.84922  20.7%  11.5  290s
 3226005 466075  540.74581   86   22  611.51457  486.72213  20.4%  11.5  295s
 3299889 470437     cutoff   70       611.51457  488.68633  20.1%  11.4  300s
 3361722 473426  585.26180   74   49  611.51457  490.33796  19.8%  11.4  305s
 3409212 476153  576.16901   63   58  611.51457  491.59557  19.6%  11.3  310s
 3480612 479495     cutoff   56       611.51457  493.37607  19.3%  11.2  315s
 3534168 481748  550.26634   39   64  611.51457  494.75568  19.1%  11.2  320s
 3588103 484317  531.74741   58   55  611.51457  496.10145  18.9%  11.2  325s
 3645883 487297  560.38336   82   32  611.51457  497.47479  18.6%  11.1  330s
 3680535 488941     cutoff   99       611.51457  498.30487  18.5%  11.1  337s
 3723923 490974  547.86583   47   61  611.51457  499.30008  18.4%  11.0  340s
 3795408 493873  507.52508   63   37  611.51457  500.98372  18.1%  11.0  345s
 3868331 496930     cutoff   62       611.51457  502.67375  17.8%  10.9  350s
 3924837 499372  547.69923   92   24  611.51457  503.92384  17.6%  10.9  355s
 4000925 502511  564.09495   64   47  611.51457  505.57848  17.3%  10.8  360s
 4055500 504817  555.01235   73   46  611.51457  506.71859  17.1%  10.8  365s
 4123196 507075  558.56110   72   46  611.51457  508.17406  16.9%  10.7  371s
 4171779 508604     cutoff   84       611.51457  509.19265  16.7%  10.7  375s
 4232379 510958     cutoff   34       611.51457  510.41577  16.5%  10.6  380s
 4293550 513237     cutoff   87       611.51457  511.59599  16.3%  10.6  385s
 4356098 515247  582.21780   87   19  611.51457  512.78215  16.1%  10.5  390s
 4415598 517204     cutoff   81       611.51457  513.88098  16.0%  10.5  400s
 4461981 518325     cutoff   76       611.51457  514.76076  15.8%  10.4  405s
 4527939 520537  602.83568   68   41  611.51457  515.95601  15.6%  10.4  410s
 4580103 521956     cutoff   49       611.51457  516.87281  15.5%  10.3  415s
 4634363 523619     cutoff   82       611.51457  517.80673  15.3%  10.3  420s
 4699312 525368     cutoff   39       611.51457  518.90616  15.1%  10.3  425s
 4748644 526374     cutoff   70       611.51457  519.74153  15.0%  10.2  430s
 4821647 527658  590.63534   77   45  611.51457  520.93387  14.8%  10.2  435s
 4873841 528878  582.17300   81   42  611.51457  521.75362  14.7%  10.1  440s
 4950223 530607  556.13004   71   44  611.51457  522.93907  14.5%  10.1  445s
 5020536 531829  576.33571   75   33  611.51457  524.04905  14.3%  10.0  452s
 5056141 532349  582.92714   68   42  611.51457  524.59732  14.2%  10.0  455s
 5131504 532827  568.02982   92   26  611.51457  525.75488  14.0%  10.0  460s
 5204949 533040  532.95855   49   55  611.51457  526.85417  13.8%   9.9  465s
 5258831 533672     cutoff   83       611.51457  527.63204  13.7%   9.9  470s
 5291979 533536  570.02681   76   42  611.51457  528.13224  13.6%   9.8  476s
 5343313 533553  579.72196   74   45  611.51457  528.88536  13.5%   9.8  480s
 5419957 533581  552.67412   96   22  611.51457  530.00488  13.3%   9.8  485s
 5495358 533658     cutoff   57       611.51457  531.08189  13.2%   9.7  490s
 5550622 533345  568.22752   94   24  611.51457  531.85144  13.0%   9.7  495s
 5615844 532674     cutoff   82       611.51457  532.77087  12.9%   9.6  500s
 5666343 532133     cutoff   53       611.51457  533.49408  12.8%   9.6  506s
 5711053 531586  537.30953   84   29  611.51457  534.12063  12.7%   9.6  510s
 5786485 530923     cutoff   85       611.51457  535.13595  12.5%   9.5  515s
 5860826 529161  549.83297   80   35  611.51457  536.15691  12.3%   9.5  520s
 5930936 527673  586.80553   65   48  611.51457  537.10083  12.2%   9.5  526s
 5985528 526450  564.01899   98   20  611.51457  537.81547  12.1%   9.4  530s
 6030731 525027     cutoff   72       611.51457  538.40742  12.0%   9.4  535s
 6093673 522983     cutoff   76       611.51457  539.23500  11.8%   9.4  540s
 6146988 521148  584.33422   58   44  611.51457  539.91117  11.7%   9.4  546s
 6197419 519016  570.42594   83   34  611.51457  540.57458  11.6%   9.3  550s
 6272421 515757  571.43384   82   32  611.51457  541.50927  11.4%   9.3  555s
 6336248 513452  550.98177   56   56  611.51457  542.29647  11.3%   9.3  560s
 6401868 510238     cutoff   60       611.51457  543.12558  11.2%   9.2  565s
 6457689 507136  568.30088   81   41  611.51457  543.84232  11.1%   9.2  570s
 6518317 503750  576.58869   62   53  611.51457  544.60388  10.9%   9.2  575s
 6568628 500317  564.75796   88   31  611.51457  545.24929  10.8%   9.1  580s
 6644970 494941  562.92218   91   27  611.51457  546.23607  10.7%   9.1  585s
 6687046 491889     cutoff   89       611.51457  546.75307  10.6%   9.1  590s
 6757526 486435  563.11917   58   57  611.51457  547.66678  10.4%   9.1  601s
 6814803 481680     cutoff   82       611.51457  548.39555  10.3%   9.0  605s
 6890296 475074  562.93676   63   52  611.51457  549.36242  10.2%   9.0  610s
 6963139 468283  594.33084   73   40  611.51457  550.31732  10.0%   9.0  615s
 7034199 461639     cutoff   96       611.51457  551.22013  9.86%   8.9  620s
 7083784 456373     cutoff   65       611.51457  551.86639  9.75%   8.9  628s
 7100330 454560     cutoff   75       611.51457  552.07877  9.72%   8.9  630s
 7173036 446225  563.12187   71   35  611.51457  553.04333  9.56%   8.9  635s
 7247853 437472  587.33410   72   46  611.51457  554.02525  9.40%   8.8  640s
 7319875 428423  572.77202   90   27  611.51457  554.98962  9.24%   8.8  645s
 7380127 420174     cutoff   34       611.51457  555.81394  9.11%   8.8  650s
 7412900 415285  558.23213   48   61  611.51457  556.26339  9.04%   8.8  655s
 7487104 404303  569.85743   67   51  611.51457  557.28535  8.87%   8.7  660s
 7555191 393774  558.53993   97   28  611.51457  558.25365  8.71%   8.7  665s
 7603922 385889     cutoff   87       611.51457  558.95698  8.59%   8.7  670s
 7678057 373290  570.55596   88   36  611.51457  560.04300  8.42%   8.7  675s
 7726407 364559  574.04883   93   23  611.51457  560.76699  8.30%   8.7  680s
 7795186 351646     cutoff   73       611.51457  561.83468  8.12%   8.6  686s
 7845652 341547     cutoff   60       611.51457  562.65828  7.99%   8.6  690s
 7920661 326108  583.72608   77   45  611.51457  563.85970  7.79%   8.6  695s
 7978602 312992  587.67021   88   21  611.51457  564.87678  7.63%   8.6  700s
 8041322 298480     cutoff   94       611.51457  565.97575  7.45%   8.5  705s
 8109123 281265     cutoff   85       611.51457  567.28340  7.23%   8.5  710s
 8174504 263614  586.97990   75   39  611.51457  568.60263  7.02%   8.5  715s
 8243321 244226  583.57423   66   41  611.51457  570.07380  6.78%   8.5  720s
 8310855 223894     cutoff   65       611.51457  571.62999  6.52%   8.4  725s
 8368318 206246     cutoff   59       611.51457  573.04186  6.29%   8.4  734s
 8377002 203183     cutoff   84       611.51457  573.27307  6.25%   8.4  735s
 8451653 177535  593.63389   93   24  611.51457  575.42127  5.90%   8.4  740s
 8526467 148580     cutoff   81       611.51457  578.00694  5.48%   8.4  745s

Explored 8593717 nodes (71756785 simplex iterations) in 749.68 seconds (781.69 work units)
Thread count was 16 (of 48 available processors)

Solution count 10: 611.515 612.716 635.41 ... 821.858

Optimal solution found (tolerance 5.00e-02)
Best objective 6.115145687862e+02, best bound 5.809809443803e+02, gap 4.9931%

Gurobi MIQP converged to an optimal solution.
Cluster Assignments from Gurobi MIQP using MSE
############################################################################

Ridge Regression using scikit-learn:
Optimal weights w* in X Space (including bias):
[ 1.15198287e+00  2.26448585e-03 -5.24231700e-04 -2.09154833e-04]

Mean Squared Error on training data (scikit-learn) with lambda = 0.1:
116.09575969333264
Cluster assignments:  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 2 2 1 2 1 2 1 2 2 2 1 1 2
 2 1 2 2 2 1 2 2 2 2 2 1 1 1 1 1 1 1 2 1 1 1 1 1 1 2 2 2 1 1 1 1 2 2 1]
-----------------------------------
Regression weights for cluster 0: y = -1.2741x_0 + -1.7979x_1 + -1.2223x_2 + -9.5664
Regression weights for cluster 0 after refit: y = -1.27x_1 + -1.7944x_2 + -1.2182x_3 + -9.582
-----------------------------------
Regression weights for cluster 1: y = 0.4813x_0 + -0.0329x_1 + -0.3749x_2 + 10.942
Regression weights for cluster 1 after refit: y = 0.4821x_1 + -0.0392x_2 + -0.381x_3 + 10.9584
-----------------------------------
Regression weights for cluster 2: y = 4.2321x_0 + 0.007x_1 + 0.3333x_2 + -0.2595
Regression weights for cluster 2 after refit: y = 4.2337x_1 + 0.0071x_2 + 0.3336x_3 + -0.262
{'time_milp': 750.7888436317444, 'time_greedy': np.float64(0.4867595434188843), 'time_refit_milp_assignment': 753.4834394454956, 'mse_refit_ground_truth_assignment': np.float64(5.011362370533162), 'r2_refit_ground_truth_assignment': 0.9598859519023044, 'weight_mismatch_refit_ground_truth_assignment': np.float64(4.046616588946403), 'refit-weight_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'rand_score_refit_ground_truth_assignment': 1.0, 'label_mismatch_refit_ground_truth_assignment': np.float64(0.0), 'mse_milp': np.float64(5.194814140600149), 'r2_milp': 0.9584174903176172, 'weight_mismatch_milp': np.float64(4.974592055912435), 'refit-weight_mismatch_milp': np.float64(4.847674844887171), 'rand_score_milp': np.float64(0.8039906103286385), 'label_mismatch_milp': np.float64(0.19444444444444445), 'mse_refit_milp_assignment': np.float64(5.19476942571556), 'r2_refit_milp_assignment': 0.9584178482432467, 'weight_mismatch_refit_milp_assignment': np.float64(4.978224222797131), 'refit-weight_mismatch_refit_milp_assignment': np.float64(4.817522461521885), 'rand_score_refit_milp_assignment': np.float64(0.8039906103286385), 'label_mismatch_refit_milp_assignment': np.float64(0.19444444444444445), 'mse_greedy': np.float64(10.114683634490575), 'r2_greedy': np.float64(0.9190358078687966), 'weight_mismatch_greedy': np.float64(18.018711222518984), 'refit-weight_mismatch_greedy': np.float64(18.14311177863655), 'rand_score_greedy': np.float64(0.7197378716744913), 'label_mismatch_greedy': np.float64(0.36180555555555555), 'mse_greedy_sem': np.float64(1.676204371185892), 'r2_greedy_sem': np.float64(0.01341737790958527), 'weight_mismatch_greedy_sem': np.float64(2.23879826628577), 'refit-weight_mismatch_greedy_sem': np.float64(2.4293109565046542), 'rand_score_greedy_sem': np.float64(0.019247898714745866), 'label_mismatch_greedy_sem': np.float64(0.03071917582159219), 'mse_ground_truth': np.float64(5.16910935107816), 'r2_ground_truth': np.float64(0.9559057160796678), 'weight_mismatch_ground_truth': 0, 'rand_score_ground_truth': 1, 'label_mismatch_ground_truth': 0, 'mse_baseline_sklearn': np.float64(116.09575969333264), 'r2_baseline_sklearn': np.float64(0.07069763789973371), 'mse_milp_val': np.float64(10.69431260393244), 'r2_milp_val': 0.898487034289061, 'label_mismatch_milp_val': np.float64(0.0625), 'mse_refit_milp_assignment_val': np.float64(10.70207332381914), 'r2_refit_milp_assignment_val': 0.8984133676850512, 'label_mismatch_refit_milp_assignment_val': np.float64(0.0625), 'mse_greedy_val': np.float64(26.95569203514939), 'label_mismatch_greedy_val': np.float64(0.3125), 'mse_greedy_val_sem': np.float64(5.093939445549377), 'label_mismatch_greedy_val_sem': np.float64(0.035638495186824125), 'r2_greedy_val': np.float64(0.744130142570121), 'r2_greedy_val_sem': np.float64(0.04835288806496162), 'mse_refit_ground_truth_assignment_val': np.float64(6.00380680732597), 'r2_refit_ground_truth_assignment_val': 0.9430104339438259, 'label_mismatch_refit_ground_truth_assignment_val': np.float64(0.125), 'mse_ground_truth_val': np.float64(5.83078894391807), 'r2_ground_truth_val': 0.9446527607661265, 'label_mismatch_ground_truth_val': np.float64(0.125), 'mse_baseline_sklearn_val': np.float64(105.91324555089061), 'r2_baseline_sklearn_val': -0.005353785898153607}
